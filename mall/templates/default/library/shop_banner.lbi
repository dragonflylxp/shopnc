{if $temp eq 'shop_banner'}
<div class="tishi">
	<div class="tishi_info">
    	{if !$uploadImage}
        <p class="first">注意：1、弹出框鼠标移到头部可以拖动，以防笔记本小屏幕内容展示不全；</p>
        {else}
        <p class="first">注意：1、请按照模板展示模式图片上面的尺寸来设置广告；</p>
        <p>2、弹出框鼠标移到头部可以拖动，以防笔记本小屏幕内容展示不全；</p>
        <i class="icon"></i>
        {/if}
    </div>
</div>
<div class="tab">
	<ul class="clearfix">
    	<li class="current">内容设置</li>
        {if $uploadImage eq 0}<li>显示设置</li>{/if}
    </ul>
</div>
<div class="modal-body">
    <div class="body_info" id="banner_info">
    	<div class="ps_table">
        <table id="addpictable" class="table">
            <thead>
                <tr>
                    <th>图片</th>
                        {if $uploadImage neq 1}
                        <th>图片链接</th>
                        <th class="center">排序</th>
                        {if $mode eq 'lunbo'}
                        <th class="center">背景颜色</th>
                        {/if}
                        {/if}
                        {if $titleup eq 1}
                        <th class="center">主标题</th>
                        <th class="center">副标题</th>
                        {/if}
                        <th class="center">操作</th>
                </tr>
            </thead>
            <tbody>
                {foreach from=$banner_list item=item key=k}
                    <tr>
                         <td>
                                <div class="img">
                                    <span><img src="{$item.pic_src}"></span>
                                    <input type="hidden" name="pic_src[]" value="{$item.pic_src}"/>
                                </div>
                            </td>
                            {if $uploadImage neq 1}
                            <td>
                                <input type="text" name="link[]" value="{$item.link}" class="form-control">
                            </td>
                            <td class="center">
                                <input type="text" value="{$item.sort}" name="sort[]" class="form-control small">
                            </td>
                            {if $mode eq 'lunbo'}
                            <td class="center">
                                <input type="text" value="{$item.bg_color}" name="bg_color[]" class="form-control small">
                            </td>
                            {/if}
                            {/if}
                            {if $titleup eq 1}
                            <td class="center">
                                <input type="text" value="{$item.title}" name="title[]" class="form-control small">
                            </td>
                            <td class="center">
                                <input type="text" value="{$item.subtitle}" name="subtitle[]" class="form-control small">
                            </td>
                            {/if}
                            <td class="center">
                                <a href="javascript:;" class="pic_del del">删除</a>
                            </td>
                    </tr>
                {foreachelse}
                	<tr class="notic">
                    	<td colspan="5">点击下列图片空间图片可添加图片或点击上传图片按钮上传新图片</td>
                    </tr>    
                {/foreach}
            </tbody>
        </table>
        </div>
        <div class="images_space">
            <div class="goods_gallery mt20">
                <form  action="" id="gallery_pic" method="post"  enctype="multipart/form-data"  runat="server" >
                    <div class="nav clearfix">
                        <div class="f_l">
                            <div class="imitate_select select_w220" id="album_id">
                                <div class="cite">请选择相册...</div>
                                <ul style="display: none;" class="ps-container" ectype="album_list_check">
                                    <li><a href="javascript:;" data-value="0" class="ftx-01">请选择...</a></li>
                                    {foreach from=$album_list item=list key=k}
                                    <li><a href="javascript:;" data-value="{$list.album_id}" class="ftx-01">{$list.album_mame}</a></li>
                                    {/foreach}
                                </ul>
                                <input name="album_id" type="hidden" value="{$album_id}" id="album_id_val">
                            </div>
                            <div class="imitate_select select_w220" id="sort_name">
                                <div class="cite">请选择相册...</div>
                                <ul style="display: none;" class="ps-container">
                                    <li><a href="javascript:;" data-value="2" class="ftx-01">按上传时间从晚到早</a></li>
                                    <li><a href="javascript:;" data-value="1" class="ftx-01">按上传时间从早到晚</a></li>
                                    <li><a href="javascript:;" data-value="3" class="ftx-01">按图片从小到大</a></li>
                                    <li><a href="javascript:;" data-value="4" class="ftx-01">按图片从大到小</a></li>
                                    <li><a href="javascript:;" data-value="5" class="ftx-01">按图片名升序</a></li>
                                    <li><a href="javascript:;" data-value="6" class="ftx-01">按图片名降序</a></li>
                                </ul>
                                <input name="sort_name" type="hidden" value="2" id="sort_name_val">
                            </div>
                        </div>
                        <div class="f_r"><i class="glyphicon glyphicon-cloud-upload"></i>上传图片<input name="file" type="file"></div>
                        <div class="f_r mr5 add_album" ectype='add_album'><i class="glyphicon"></i>添加相册</div>
                    </div>
                </form>
                <div class="table_list" ectype='pic_list'>
                    <div class="gallery_album" data-act="get_albun_pic" data-inid="pic_list" data-url='get_ajax_content.php' data-where="sort_name={$filter.sort_name}&album_id={$filter.album_id}">
                        <ul class="ga-images-ul">
                            {foreach from=$pic_list item=pic_list}
                            <li><a href="javascript:;" onclick="addpic('{$pic_list.pic_file}',this)"><img src="{$pic_list.pic_file}"><span class="pixel">{$pic_list.pic_spec}</span></a></li>
                            {foreachelse}
                            <li class="notic">暂无图片</li>
                            {/foreach}
                        </ul>
                        <div class="clear"></div>
                        {include file="library/lib_page.lbi"}
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="body_info" style="display:none;">
    	<div class="control_list">
        	<div class="control_item">
                <div class="control_text">图片高度：</div>
                <div class="control_value">
                	{if $mode eq 'lunbo'}
                	<input type="text" name="picHeight" value="{if $spec_attr.picHeight}{$spec_attr.picHeight}{else}600{/if}" class="shop_text" autocomplete="off" /><span>px</span><span>请设置在300-600px这个之间</span>
                    {elseif $mode eq 'advImg1'}
                    <input type="text" name="picHeight" value="{if $spec_attr.picHeight}{$spec_attr.picHeight}{else}400{/if}" class="shop_text" autocomplete="off" /><span>px</span><span>根据实际需求自行填写高度，默认为400</span>
                    {elseif $mode eq 'advImg2'}
                    <input type="text" name="picHeight" value="{if $spec_attr.picHeight}{$spec_attr.picHeight}{else}650{/if}" class="shop_text" autocomplete="off" /><span>px</span><span>根据实际需求自行填写高度，默认为650</span>
                    {elseif $mode eq 'advImg3'}
                    <input type="text" name="picHeight" value="{if $spec_attr.picHeight}{$spec_attr.picHeight}{else}380{/if}" class="shop_text" autocomplete="off" /><span>px</span><span>根据实际需求自行填写高度，默认为380</span>
                    {elseif $mode eq 'advImg4'}
                    <input type="text" name="picHeight" value="{if $spec_attr.picHeight}{$spec_attr.picHeight}{else}250{/if}" class="shop_text" autocomplete="off" /><span>px</span><span>根据实际需求自行填写高度，默认为250</span>
                	{/if}
                </div>
            </div>
            {if $mode eq 'lunbo' || $mode eq 'advImg1'}
            <div class="control_item">
                <div class="control_text">切换效果：</div>
                <div class="control_value">
                	<div class="checkbox_items">
                        <div class="checkbox_item">
                            <input type="radio" name="slide_type" value="fold" class="ui-radio" id="shade" {if $spec_attr.slide_type neq 'roll'}checked{/if} >
                            <label class="ui-radio-label" for="shade">渐变</label>
                        </div>
                        <div class="checkbox_item">
                            <input type="radio" name="slide_type" value="roll" class="ui-radio" id="roll" {if $spec_attr.slide_type eq 'roll'}checked{/if}>
                            <label class="ui-radio-label" for="roll">滚动</label>
                        </div>
                    </div>
                </div>
            </div>
            {/if}
            {if $mode eq 'advImg4'}
            <div class="control_item">
                <div class="control_text">展示方式：</div>
                <div class="control_value">
                	<div class="itemsLayout line-item3" data-line="row3">
                    	<div class="itemsLayoutShot {if $spec_attr.itemsLayout eq 'row3'}dtselected{/if}"><a href="javascript:void(0);"><span></span></a></div>
                        <div class="dd">展示3个广告位<br>（建议尺寸394*394）</div>
                    </div>
                    <div class="itemsLayout line-item4" data-line="row4">
                    	<div class="itemsLayoutShot {if $spec_attr.itemsLayout eq 'row4'}dtselected{/if}"><a href="javascript:void(0);"><span></span></a></div>
                        <div class="dd">展示4个广告位<br>（建议尺寸292*350）</div>
                    </div>
                    <div class="itemsLayout line-item5" data-line="row5">
                    	<div class="itemsLayoutShot {if $spec_attr.itemsLayout eq 'row5'}dtselected{/if}"><a href="javascript:void(0);"><span></span></a></div>
                        <div class="dd">展示5个广告位<br>（建议尺寸232*337）</div>
                    </div>
                    <div class="itemsLayout line-item6" data-line="row6">
                    	<div class="itemsLayoutShot {if $spec_attr.itemsLayout eq 'row6' || $spec_attr.itemsLayout eq ''}dtselected{/if}"><a href="javascript:void(0);"><span></span></a></div>
                        <div class="dd">展示6个广告位<br>（建议尺寸190*250）</div>
                    </div>
                </div>
            </div>
            <input name="itemsLayout" type="hidden" value="{if $spec_attr.itemsLayout}{$spec_attr.itemsLayout}{else}row6{/if}"/>
            {/if}
            {if $mode eq 'advImg3'}
            <div class="control_item">
                <div class="control_text">展示方式：</div>
                <div class="control_value">
                	<div class="itemsLayout line-item-left-right" data-line="left-right">
                    	<div class="itemsLayoutShot {if $spec_attr.itemsLayout eq 'left-right' || $spec_attr.itemsLayout eq ''}dtselected{/if}"><a href="javascript:void(0);"><span></span></a></div>
                        <div class="dd">左小图右大图</div>
                    </div>
                    <div class="itemsLayout line-item-right-left" data-line="right-left">
                    	<div class="itemsLayoutShot {if $spec_attr.itemsLayout eq 'right-left'}dtselected{/if}"><a href="javascript:void(0);"><span></span></a></div>
                        <div class="dd">左大图右小图</div>
                    </div>
                </div>
            </div>
            <input name="itemsLayout" type="hidden" value="{if $spec_attr.itemsLayout}{$spec_attr.itemsLayout}{else}left-right{/if}"/>
            {/if}
            <div class="control_item">
                <div class="control_text">是否新窗口打开：</div>
                <div class="control_value">
                	<div class="checkbox_items">
                        <div class="checkbox_item">
                            <input type="radio" name="target" value="_blank" class="ui-radio" id="blank" {if $spec_attr.target neq '_self'}checked{/if} >
                            <label class="ui-radio-label" for="blank">是</label>
                        </div>
                        <div class="checkbox_item">
                            <input type="radio" name="target" value="_self" class="ui-radio" id="self" {if $spec_attr.target eq '_self'}checked{/if}>
                            <label class="ui-radio-label" for="self">否</label>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>      
<script type="text/javascript">
    imitate_select();
    $.divselect("#album_id","#album_id_val",function(obj){
        var val = obj.attr("data-value");
        changedpic(val,obj);
    });
    $.divselect("#sort_name","#sort_name_val",function(obj){
        changedpic(0,obj);
    });
	$("input[name='file']").change(function(){
		var album_id = $("input[name='album_id']").val();
		if(album_id > 0){
			var actionUrl = "index.php?con=visual_editing&fun=upload_pic";
			$("#gallery_pic").ajaxSubmit({
				type: "POST",
				dataType: "json",
				url: actionUrl,
				data: { "action": "TemporaryImage" },
				success: function (data) {
						if (data.error == "1") {
							alert(data.massege);
						}else{
							changedpic(0);
						}
				},
				async: true
			});
		}else{
			alert("请选择相册");
		}
	});
	//function changedpic(val,obj){
	//	var album_id = 0;
	//	if(val > 0){
	//		album_id = val;
	//	}else{
	//		album_id = $("input[name='album_id']").val();
	//	}
		//var sort_name = $("input[name='sort_name']").val();
		
		//Ajax.call('get_ajax_content.php?is_ajax=1&act=get_albun_pic', "sort_name="+sort_name+"&album_id="+album_id, function(data){
			//$("[ectype='pic_list']").html(data.content);
			//$("[ectype='pic_list']").perfectScrollbar("destroy");
			//$("[ectype='pic_list']").perfectScrollbar();
			
			//if(obj){
			//	var id = $(obj).parents(".pb").attr("id");
			//	pbct("#" + id);
			//}else{
			//	pbct();
			//}
		//} , 'POST', 'JSON');
	
	//} 
	function addpic(src,obj){
		var i = 0;
		var mode = "{$mode}";
		var length = "{$pic_number}";
                var uploadImage = "{$uploadImage}";
		var titleup = "{$titleup}";
		var id = $(obj).parents(".pb").attr("id");
		$("#addpictable").find('tr').each(function(){
			i++
		});
		
		if($("#addpictable").find('tr.notic').length>0){
			i-=1;
		}

		if( length< i  && length != 0){
			alert("此模块最多可添加"+length+"个图片");
		}else{
                        if(mode != "lunbo"){
				if(uploadImage == 1){
					var html = '<tr><td><div class="img"><span><img src="'+src+'"></span><input type="hidden" name="pic_src[]" value="'+src+'"/></div></td><td class="center"><a href="javascript:;" class="pic_del del">删除</a></td></tr>';
				}else{
					var title = '';
					if(titleup == 1){
						title = '<td class="center"><input type="text" value="" name="title[]" class="form-control small"></td><td class="center"> <input type="text" value="" name="subtitle[]" class="form-control small"></td>';
					}
					var html = '<tr><td><div class="img"><span><img src="'+src+'"></span><input type="hidden" name="pic_src[]" value="'+src+'"/></div></td><td><input type="text" name="link[]" class="form-control"></td><td class="center"><input type="text" value="1" name="sort[]" class="form-control small"></td>' + title + '<td class="center"><a href="javascript:;" class="pic_del del">删除</a></td></tr>';
				}
			}else{
				var html = '<tr><td><div class="img"><span><img src="'+src+'"></span><input type="hidden" name="pic_src[]" value="'+src+'"/></div></td><td><input type="text" name="link[]" class="form-control"></td><td class="center"><input type="text" value="1" name="sort[]" class="form-control small"></td><td class="center"><input type="text" value="" name="bg_color[]" class="form-control small"></td><td class="center"><a href="javascript:;" class="pic_del del">删除</a></td></tr>';
			}
			
			if($("#addpictable").find(".notic").length>0){
				$("#addpictable").find(".notic").remove();
			}
			$("#addpictable").find("tbody").prepend(html);
		}
		
		pbct("#"+id);
	}
    
	//添加相册
    //$(document).on("click",".add_album",function(){
    //    Ajax.call('index.php?&con=visual_editing&is_ajax=1&fun=add_albun_pic', '', add_albumResponse , 'POST', 'JSON');
    //});
 
    //function add_albumResponse(data){
    //    var content = data.content;
	//	pb({
	//		id: "add_albun_piccomtent",
	//		title: "图片编辑器",
	//		width: 950,
	//		content: content,
	//		ok_title: "确定",
	//		drag: true,
	//		foot: true,
	//		cl_cBtn: false,
	//		onOk: function () {
	//			var parents = $("#add_albun_pic");
	//			var required = parents.find("*[ectype='required']");
//
	//			if(validation(required) == true){
	//				var actionUrl = "get_ajax_content.php?act=add_albun_pic";
	//				$("#add_albun_pic").ajaxSubmit({
	//					type: "POST",
	//					dataType: "json",
	//					url: actionUrl,
	//					data: { "action": "TemporaryImage" },
	//					success: function (data) {
	//						if (data.error == "0") {
	//							alert(data.content);
	//						}else{
	//							$("[ectype='album_list_check']").html(data.content)
	//							$("input[name='album_id']").val(data.pic_id);
     //                                                           imitate_select();
	//							changedpic(data.pic_id);
	//						}
	//						return true;
	//					},
	//					async: true
	//				});
	//				return true;
	//			}else{
	//				return false;
	//			}
	//		}
	//	});
    //}
    //select下拉默认值赋值
            function imitate_select(){
                $('.imitate_select').each(function()
                {
                        var sel_this = $(this)
                        var val = sel_this.children('input[type=hidden]').val();
                        sel_this.find('a').each(function(){
                                if($(this).attr('data-value') == val){
                                        sel_this.children('.cite').html($(this).html());
                                }
                        })
                });
            }
</script>
{/if}

{if $temp eq 'goods_info'}
<div class="tishi">
	<div class="tishi_info">
        <p class="first">注意：1、弹出框鼠标移到头部可以拖动，以防笔记本小屏幕内容展示不全；</p>
    </div>
</div>
{if $goods_type neq 1}
<div class="tab">
	<ul class="clearfix">
    	<li class="current">内容设置</li>
        <li>显示设置</li>
    </ul>
</div>
{/if}

<div class="modal-body">
	<div class="body_info floor_info">
        <div class="search">
            <div class="select_box mr10">
<!--                {if $select_category_html}{$select_category_html}{/if}
                <input type="hidden" name="cat_id" id="cat_id" value="{$cat_id|default:0}"/>-->
                <!--<div class="categorySelect">
                    <div class="selection">
                        <input type="text" name="category_name" id="category_name" class="text w250 mr0 valid" value="{if $parent_category}{$parent_category}{else}顶级分类{/if}" autocomplete="off" readonly data-filter="cat_name" />
                        <input type="hidden" name="cat_id" id="category_id" ectype="goods_cat_dialog" value="{$cat_id|default:0}" data-filter="cat_id" />
                    </div>
                    <div class="select-container" style="display:none;">
                        {include file="library/filter_category.lbi"}
                    </div>
                </div>-->
            </div>
            <div class="search_con"><input width="20" name="keyword_brand" type="text" id="keyword_brand" placeholder="搜索店铺商品" class="text text_6"></div>
            <a href="javascript:void(0);" class="btn fl" ectype="changedgoods">确定</a>
            <div class="checkobx-item">
                <input type="checkbox" name="is_selected" id="is_selected" class="ui-checkbox" onclick="checkd_selected(this)"/>
                <label class="ui-label" for="is_selected">已选择商品</label>
            </div>
        </div>
        <div class="table_list" ectype='goods_list'>
            <div class="gallery_album" data-act="changedgoods" data-goods='1' data-inid="goods_list" data-url='get_ajax_content.php' data-where="cat_id={$filter.cat_id}&search_type={$filter.search_type}&sort_order={$filter.sort_order}&keyword={$filter.keyword}&type=1">
                <ul class="ga-goods-ul" id="goods_list">
                    {foreach from=$goods_list item=goods name=gl}
                    <li class="on">
                        <div class="img"><img src="{$goods.goods_thumb}"  width="50" height="50"></div>
                       <div class="text">
                            <p class="name">{$goods.goods_name}</p>
                            <p class="price">
                                {if $goods.promote_price neq ''}
                                {$goods.promote_price}
                                {else}
                                {$goods.shop_price}
                                {/if}
                            </p>
                        </div>
                        <div class="choose"><a href="javascript:void(0);" class="on" onclick="selected_goods(this,'{$goods.goods_id}')"><i class="iconfont icon-gou"></i>已选择</a></div>
                    </li>
                    {foreachelse}
                    <li class="notic">请先搜索商品</li>
                    {/foreach}
                </ul>
            </div>
        </div>
    </div>
    <div class="body_info floor_info" style="display:none;">
        <div class="control_list">
        	<div class="control_item">
                <div class="control_text">是否显示标题：</div>
                <div class="control_value">
                	<div class="checkbox_items">
                        <div class="checkbox_item">
                        	<input type="radio" name="is_title" value="1" class="ui-radio" id="is_title_1" {if $arr.is_title neq 0} checked {/if}>
                        	<label class="ui-radio-label" for="is_title_1">是</label>
                        </div>
                        <div class="checkbox_item">
                        	<input type="radio" name="is_title" value="0" class="ui-radio" id="is_title_0" {if $arr.is_title eq 0} checked {/if}>
                            <label class="ui-radio-label" for="is_title_0">否</label>
                        </div>    
                    </div>
                </div>
            </div>
            <div class="tit_head"{if $arr.is_title eq 0} style="display:none;"{/if}>
                <div class="control_item">
                    <div class="control_text">楼层名称：</div>
                    <div class="control_value"><input name="cat_name" type="text" class="text text2" size="25" value="{$arr.cat_name}"></div>
                </div>
                <div class="control_item">
                    <div class="control_text">楼层描述：</div>
                    <div class="control_value"><input name="cat_desc" type="text" class="text" size="25" value="{$arr.cat_desc}"></div>
                </div>
                <div class="control_item">
                    <div class="control_text">文字显示：</div>
                    <div class="control_value">
                        <select class="select" name="align">
                            <option value="left" {if $arr.align eq 'left'}checked {/if}>居左</option>
                            <option value="center" {if $arr.align eq 'center'}checked {/if}>居中</option>
                            <option value="regiht" {if $arr.align eq 'regiht'}checked {/if}>居右</option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="control_item">
                <div class="control_text">展示方式：</div>
                <div class="control_value">
                	<div class="itemsLayout line-item3" data-line="row3">
                    	<div class="itemsLayoutShot {if $arr.itemsLayout eq 'row3'}dtselected{/if}"><a href="javascript:void(0);"><span></span></a></div>
                        <div class="dd">一行展示3个商品</div>
                    </div>
                    <div class="itemsLayout line-item4" data-line="row4">
                    	<div class="itemsLayoutShot {if $arr.itemsLayout eq 'row4'}dtselected{/if}"><a href="javascript:void(0);"><span></span></a></div>
                        <div class="dd">一行展示4个商品</div>
                    </div>
                    <div class="itemsLayout line-item5" data-line="row5">
                    	<div class="itemsLayoutShot {if $arr.itemsLayout eq 'row5'}dtselected{/if}"><a href="javascript:void(0);"><span></span></a></div>
                        <div class="dd">一行展示5个商品</div>
                    </div>
                </div>
            </div>
            <input name="itemsLayout" type="hidden" value="{$arr.itemsLayout}"/>
			<input type="hidden" name="search_type" value="{$search_type}"/>
        </div>    
    </div>
</div>
<input type="hidden" name="goods_ids" value="{$arr.goods_ids}"/>
<script language="JavaScript">

    ajaxchangedgoods(1);
    function checkd_selected(){
        var is_selected =$("input[name='is_selected']").is(':checked');
        var type = 1;
        if(is_selected == true){
            $(".icon-gou").parents('li').show();
			$(".icon-dsc-plus").parents('li').hide();
                        type = 0;
        }else{
            $(".icon-gou,.icon-dsc-plus").parents('li').show();
        }
        ajaxchangedgoods(type);
    }
    $(document).on("click","button[ectype='changedgoods']",function(){
        ajaxchangedgoods(1);
    })

	
	function ajaxchangedgoods(type){
        var cat_id = $("[ectype='goods_cat_dialog']").val();
        var keyword = $("input[name='keyword_brand']").val();
        var goods_ids = $("input[name='goods_ids']").val();
		var search_type = $("input[name='search_type']").val();
		$("[ectype='goods_list']").html("<i class='icon-spin'><img src='images/visual/load.gif' width='30' height='30'></i>");
		
		function ajax(){
			Ajax.call('index.php?con=visual_editing&fun=changedgoods&is_ajax=1', "cat_id="+cat_id+"&keyword="+keyword+"&goods_ids="+goods_ids+"&type="+type + "&resetRrl=1&search_type=" + search_type, function(data){
				$("[ectype='goods_list']").html(data.content);
				
				$("*[ectype='goods_list']").perfectScrollbar("destroy");
				$("*[ectype='goods_list']").perfectScrollbar();
			} , 'POST', 'JSON');
		}
		
		setTimeout(function(){ajax()},300);
    }

	//选中商品
	function selected_goods(obj,goods_id){
		var obj = $(obj);
		var arr = '';
		var goods_ids = $("input[name='goods_ids']").val();
	   
		if(obj.hasClass("on")){
			obj.removeClass("on");
			obj.html('<i class="iconfont icon-dsc-plus"></i>选择');
			arr = goods_ids.split(',');
			for(var i =0;i<arr.length;i++){
				if(arr[i] == goods_id){
					 arr.splice(i,1);
				}
			}
		}else{
			$(obj).addClass('on');
			$(obj).html('<i class="iconfont icon-gou"></i>已选择');
			if(goods_ids){
					arr = goods_ids + ','+goods_id;
			}else{
					arr = goods_id;
			}
		}
		$("input[name='goods_ids']").val(arr);
	}
	
	$("input[name='is_title']").on("click",function(){
		var val = $(this).val();
		if(val == 1){
			$(this).parents(".control_list").find(".tit_head").show();
		}else{
			$(this).parents(".control_list").find(".tit_head").hide();
		}
	});
</script>
{/if}

{if $temp eq 'header'}
<div class="tishi">
	<div class="tishi_info">
	<p class="first">注意：1、弹出框鼠标移到头部可以拖动，以防笔记本小屏幕内容展示不全;</p>
    <p>2、自定义编辑器里面的编辑模板，样式可以写在编辑器里面;</p>
    </div>
</div>
<div class="tab">
	<ul class="clearfix">
    	<li class="current">内容设置</li>
    </ul>
</div>
<div class="modal-body">
	<div class="control_list">
        <div class="control_item">
            <div class="control_text">设置类型：</div>
            <div class="control_value">
            	<label><input type="radio" name="header_type" value="defalt_type" class="checkbox" {if $content.header_type eq 'defalt_type'}checked{/if}><span>默认类型</span></label>
                <label><input type="radio" name="header_type" value="custom_type" class="checkbox" {if $content.header_type eq 'custom_type'}checked{/if}><span>自定义类型</span></label>
            </div>
        </div>
        <div class="defalt_type" {if $content.header_type neq 'defalt_type'}style="display:none;"{/if}>
            <div class="control_item">
                <div class="control_text">头部图片：</div>
                <form  action="" id="fileForm" method="post"  enctype="multipart/form-data"  runat="server" >
                    <div class="control_value relative">
                        <a href="javascript:void(0);" class="uploader-button">
                        	<span class="btn-text">选择文件</span>
                        	<div class="file-input-wrapper"><input type="file" name="headerFile" value="上传图片" id="headerFile"  class="file-header-img"></div>
                        </a>
                        <div class="preview-box"><input name="fileimg" type="hidden" value="{if $content.headerbg_img}{$content.headerbg_img}{else}../data/gallery_album/ksh_bg.jpg{/if}"/><img id="headerbg_img" src="{if $content.headerbg_img}{$content.headerbg_img}{else}../data/gallery_album/ksh_bg.jpg{/if}" height="86"></div>
                    </div>
                </form>
            </div>
        </div>
        <div class="custom_type" {if $content.header_type eq 'defalt_type'}style="display:none;"{/if}>
        	<div class="control_item">
                <div class="control_text">自定义内容：</div>
                <div class="control_value over">
                    {$FCKeditor}
                </div>
            </div>
        </div>
        <div class="control_item">
            <div class="control_text">高度：</div>
            <div class="control_value"><input type="text" name="picHeight" value="{if $content.picHeight}{$content.picHeight}{else}128{/if}" class="shop_text" autocomplete="off" /><span>px</span><span>请设置在120-150px这个之间</span></div>
        </div>
	</div>        
</div>
<script type="text/javascript">
    var suffix = "{$content.suffix}";
	$.upload_file("input[name='headerFile']","visual_editing.php?act=header_bg&name=headerFile&suffix="+suffix+"&topic_type="+topic_type,"#headerbg_img");
	
	$(document).on("click","input[name='header_type']",function(){
		if($(this).val() == "defalt_type"){
			$(".defalt_type").show().siblings(".custom_type").hide();
			pbct();
		}else{
			$(".custom_type").show().siblings(".defalt_type").hide();
			pbct();
		}
	});
</script>
{/if}

{if $temp eq 'navigator'}
<div class="tishi">
	<div class="tishi_info">
	<p class="first">注意：1、弹出框鼠标移到头部可以拖动，以防笔记本小屏幕内容展示不全;&nbsp;&nbsp;&nbsp;&nbsp;2、切换是否显示，点击对应的小图标即可完成切换</p>
    </div>
</div>
<div class="tab">
	<ul class="clearfix">
    	<li class="current">内容设置</li>
        {if $topic_type neq 'topic_type'}<li>显示设置</li>{/if}
    </ul>
</div>
<div class="modal-body">
	<div class="body_info">
    	<div class="ov_list">
        <form action="" id="navInsert" method="post"  enctype="multipart/form-data"  runat="server" >
    	<table class="table" data-table="navtable">
        	<thead>
                <tr>
                    <th width="30%">分类名称</th>
                    <th width="25%">链接地址</th>
                    <th width="15%" class="center">排序</th>
                    {if $topic_type neq 'topic_type'}
                    <th width="20%" class="center">是否显示</th>
                    {/if}
                    <th width="15%" class="center">操作</th>
                </tr>
            </thead>
            <tbody>
                {foreach from=$navigator item=navigator}
            	<tr>
                	<td><input type="text" {if $topic_type neq 'topic_type'}onchange = "edit_nav(this.value ,'{$navigator.id}','edit_navname')"{/if} name="navname[]" value="{$navigator.name}"></td>
                    <td><input type="text" {if $topic_type neq 'topic_type'}onchange = "edit_nav(this.value ,'{$navigator.id}','edit_navurl')"{/if} name="navurl[]" value="{$navigator.url}"></td>
                    <td class="center"><input type="text" {if $topic_type neq 'topic_type'}onchange = "edit_nav(this.value ,'{$navigator.id}','edit_navvieworder')"{/if} class="small" name="navvieworder[]" value="{$navigator.vieworder}"></td>
                    {if $topic_type neq 'topic_type'}
                    <td class="center" id="nav_{$navigator.id}"><img onclick = "edit_nav('{$navigator.ifshow}' ,'{$navigator.id}','edit_ifshow','1')" src="{if $navigator.ifshow eq 1}images/yes.gif{else}images/no.gif{/if}"/></td>
                    {/if}
                    <td class="center"><a href="javascript:void(0);" {if $topic_type neq 'topic_type'}onclick="remove_nav('{$navigator.id}')"{else}onclick="remove_topicnav(this)"{/if} class="pic_del del">删除</a></td>
                </tr>
                {foreachelse}
                <tr class="notic">
                    <td colspan="4">当前没有自定义商品分类，点击下面添加新分类添加</td>
                </tr>
            	{/foreach}
            </tbody>
        </table>
            </form>
        </div>
        <div class="addCatagory" ectype="addCatagory">
        	<select class="select" id="catagory_type" {if $topic_type eq 'topic_type'}style="display:none;" {/if}>
                <option value="0">请选择</option>
                <option value="1">自定义分类</option>
                <option value="2">店铺分类</option>
            </select>
            <input type="text" name="custom_catagory" class="text" {if $topic_type neq 'topic_type'}style="display:none;" {/if}/>
            <select class="select" id="sys_catagory" style="display:none;">
                {foreach from=$sysmain item=val key=key}
                    <option value='{$key}|{$val.cat_id}|{$val.cat_name}|{$val.url}' id="" url="{$val.url}">{$val.cat_name}</option>
                {/foreach}
            </select>
            <a href="javascript:void(0);" class="{if $topic_type eq 'topic_type'}btn{else}btn btn_disabled{/if}" ectype="{if $topic_type eq 'topic_type'}topic_btn{else}store_btn{/if}">添加新分类</a>
        </div>
    </div>
    <div class="body_info" style="display:none;">
    	<div class="control_list">
            <div class="control_item">
                <div class="control_text">导航栏背景色：</div>
                <div class="control_value">
                    <input type="text" name="navColor" class="navColor" value="{if $attr.navColor}{$attr.navColor}{else}#000{/if}">
                </div>
            </div>
            <div class="control_item">
                <div class="control_text">是否新窗口打开：</div>
                <div class="control_value">
                	<label><input type="radio" name="target" value="_blank" class="checkbox" {if $attr.target eq '_blank'} checked{/if}><span>是</span></label>
                    <label><input type="radio" name="target" value="_self" class="checkbox" {if $attr.target eq '_self'} checked{/if}><span>否</span></label>
                </div>
            </div>
            <div class="control_item">
                <div class="control_text">文字显示：</div>
                <div class="control_value">
                	<select class="select" name="align">
                        <option value="left" {if $attr.align eq 'left'}selected="selected" {/if}>居左</option>
                        <option value="center" {if $attr.align eq 'center'}selected="selected" {/if}>居中</option>
                        <option value="regiht" {if $attr.align eq 'regiht'}selected="selected" {/if}>居右</option>
                    </select>
                </div>
            </div>
        </div>
    </div>
</div>
<script type="text/javascript">
	var navColor = $(".navColor").val();
	$(".navColor").spectrum({
		showInitial: true,
		showPalette: true,
		showSelectionPalette: true,
		showInput: true,
		color: navColor,
		showSelectionPalette: true,
		maxPaletteSize: 10,
		preferredFormat: "hex",
		palette: [
			["rgb(0, 0, 0)", "rgb(67, 67, 67)", "rgb(102, 102, 102)",
			"rgb(204, 204, 204)", "rgb(217, 217, 217)","rgb(255, 255, 255)"],
			["rgb(152, 0, 0)", "rgb(255, 0, 0)", "rgb(255, 153, 0)", "rgb(255, 255, 0)", "rgb(0, 255, 0)",
			"rgb(0, 255, 255)", "rgb(74, 134, 232)", "rgb(0, 0, 255)", "rgb(153, 0, 255)", "rgb(255, 0, 255)"], 
			["rgb(230, 184, 175)", "rgb(244, 204, 204)", "rgb(252, 229, 205)", "rgb(255, 242, 204)", "rgb(217, 234, 211)", 
			"rgb(208, 224, 227)", "rgb(201, 218, 248)", "rgb(207, 226, 243)", "rgb(217, 210, 233)", "rgb(234, 209, 220)", 
			"rgb(221, 126, 107)", "rgb(234, 153, 153)", "rgb(249, 203, 156)", "rgb(255, 229, 153)", "rgb(182, 215, 168)", 
			"rgb(162, 196, 201)", "rgb(164, 194, 244)", "rgb(159, 197, 232)", "rgb(180, 167, 214)", "rgb(213, 166, 189)", 
			"rgb(204, 65, 37)", "rgb(224, 102, 102)", "rgb(246, 178, 107)", "rgb(255, 217, 102)", "rgb(147, 196, 125)", 
			"rgb(118, 165, 175)", "rgb(109, 158, 235)", "rgb(111, 168, 220)", "rgb(142, 124, 195)", "rgb(194, 123, 160)",
			"rgb(166, 28, 0)", "rgb(204, 0, 0)", "rgb(230, 145, 56)", "rgb(241, 194, 50)", "rgb(106, 168, 79)",
			"rgb(69, 129, 142)", "rgb(60, 120, 216)", "rgb(61, 133, 198)", "rgb(103, 78, 167)", "rgb(166, 77, 121)",
			"rgb(91, 15, 0)", "rgb(102, 0, 0)", "rgb(120, 63, 4)", "rgb(127, 96, 0)", "rgb(39, 78, 19)", 
			"rgb(12, 52, 61)", "rgb(28, 69, 135)", "rgb(7, 55, 99)", "rgb(32, 18, 77)", "rgb(76, 17, 48)"]
		]
	});
	$(".sp-choose").click(function(){
		var val = $(this).parents(".sp-picker-container").find(".sp-input").val();
		$(".navColor").val(val);
	});
        function remove_topicnav(obj){
            $(obj).parents('tr').remove();
        }
        function edit_nav(val,id,act,type){
            if(id > 0){
                if(type == 0){
                    Ajax.call('index.php?con=visual_editing&fun='+act+'&is_ajax=1&act='+act, "val=" +encodeURIComponent(val) + "&id=" + id , edit_navnameResponse, 'POST', 'JSON');
                }else{
                    Ajax.call('index.php?con=visual_editing&fun='+act+'&is_ajax=1&act='+act, "val=" +encodeURIComponent(val) + "&id=" + id , edit_ifshowResponse, 'POST', 'JSON');
                }
                
            }else{
                alert("导航不存在");
            }
        }

        function edit_navnameResponse(data){
            if(data.error == 0){
                alert(data.content);
            }
        }
        function edit_ifshowResponse(data){
            var obj = $("#nav_"+data.id);
            if(data.error == 0){
                alert(data.content);
            }else{
                if(data.content == 0){
                    obj.html(data.content)
                }else{
                    obj.html(data.content)
                }
            }
        }
        function remove_nav(id){
            if(id > 0){
                Ajax.call('get_ajax_content.php?is_ajax=1&act=remove_nav', "id=" + id , remove_navResponse, 'POST', 'JSON');
            }else{
                alert("导航不存在");
            }
        }

        function remove_navResponse(data){
            if(data.error == 0){
                alert(data.content);
            }
        }
       
</script>
{/if}
{if $temp eq 'custom'}
<div class="tishi">
	<div class="tishi_info">
        <p class="first">注意：1、弹出框鼠标移到头部可以拖动，以防笔记本小屏幕内容展示不全；</p>
    </div>
</div>
<div class="modal-body">{$FCKeditor}</div>
{/if}
{if $temp eq 'template_information'}
<form  action="visual_editing.php?act=edit_information" id="information" method="post"  enctype="multipart/form-data"  runat="server" >
<div class="modal-body">
    <div class="body_info">
    	<div class="control_list">
            <div class="control_item">
                <div class="control_text">模板名称：</div>
                <div class="control_value">
                	<input type="text" class="text" name="name"  value="{$template.name|escape}"  autocomplete="off" />
                </div>
            </div>
            <div class="control_item">
                <div class="control_text">版本：</div>
                <div class="control_value">
                	<input type="text" class="text" name="version"  value="{$template.version|escape}"  autocomplete="off" />
                </div>
            </div>
            <div class="control_item">
                <div class="control_text">作者：</div>
                <div class="control_value">
                	<input type="text" class="text" name="author"  value="{$template.author|escape}"  autocomplete="off" />
                </div>
            </div>
            <div class="control_item">
                <div class="control_text">作者链接：</div>
                <div class="control_value">
                	<input type="text" class="text" name="author_url"  value="{$template.author_uri|escape}"  autocomplete="off" />
                </div>
            </div>
            <div class="control_item">
                <div class="control_text">模板封面：</div>
                <div class="control_value">
                        <input type="file" class="type-file-file" id="ten_file" name="ten_file" data-state="imgfile" size="30" hidefocus="true" value="" />
                        {if $template.screenshot}
                        <img src={$template.screenshot} width="25" height="25"/>
                        {/if}
                        <span class="hint" style="color:#1b9ad5;">请上传265*388的图片，防止图片变型</span>
                </div>
            </div>
            <div class="control_item">
                <div class="control_text">模板大图：</div>
                <div class="control_value">
                        <input type="file" class="type-file-file" id="big_file" name="big_file" data-state="imgfile" size="30" hidefocus="true" value="" />
                        {if $template.template}
                        <img src={$template.template} width="25" height="25"/>
                        {/if}
                </div>
            </div>
            <div class="control_item">
                <div class="control_text">描述：</div>
                <div class="control_value">
                	<textarea class="textarea" name="description">{$template.desc|escape}</textarea>
                </div>
            </div>
            <input type="hidden" name="tem" value="{$code}" />
            <input type="hidden" name="id" value="{$ru_id}" />
        </div>
    </div>
</div>
</form>
{/if}
{if $temp eq 'homeFloor'}
<!--首页楼层-->
<form action="" id="{$mode}Insert" method="post" enctype="multipart/form-data" runat="server" >
    <div class="tab">
        <ul class="clearfix">
            <li class="current">楼层分类设置</li>
            <li>楼层广告设置</li>
            {if $mode neq 'homeFloorFive'}
            <li>楼层品牌设置</li>
            {/if}
        </ul>
    </div>
    <div class="modal-body hfloor">
        <div class="body_info">
            <div class="control_list">
                <div class="control_item">
                    {if $hierarchy neq '2'}
                    <div class="control_item">
                        <div class="control_text"><em class="red">*</em>模块名称：</div>
                        <div class="control_value"><input type="text" value="{$lift}" class="text" name="lift" autocomplete="off" maxlength="2" placeholder="请填写电梯层标题" ectype="required" data-msg="请填写电梯层标题" /><div class="notic">模块名称是显示首页左侧浮动导航；只能2个中文字符，如：店铺</div></div>
                    </div>
                    {/if}
                    <div class="control_item">
                        <div class="control_text">标题：</div>
                        <div class="control_value"><input type="text" value="{$spec_attr.floor_title}" class="text" name="floor_title" autocomplete="off" placeholder="楼层标题"  data-msg="楼层标题" /><div class="notic">楼层标题，不填则默认为选择的楼层分类</div></div>
                    </div>
                    <div class="control_text lh30">楼层分类：</div>
                    <div class="control_value">
                        <div class="imitate_select select_w220" id="cat_id">
                            <div class="cite">请选择</div>
                            <ul>
                                <li><a href="javascript:void(0);" data-value="">请选择...</a></li>
                                {foreach from=$cat_list item=list}
                                <li{if $list.cat_id eq $spec_attr.Selected} class="current"{/if}><a href="javascript:void(0);" data-value="{$list.cat_id}">{$list.cat_name}</a></li>
                                {/foreach}
                            </ul>
                            <input name="" value="{$spec_attr.Selected}" type="hidden" id='cat_id_val'/>
                        </div>
                        <div class="cat_floor">
                            {if $spec_attr.catChild}
                            <div class="imitate_select select_w220" id="cat_id1">
                                <div class="cite">请选择</div>
                                <ul>
                                    <li><a href="javascript:void(0);" data-value="">{$lang.select_please}</a></li>
                                    {foreach from=$spec_attr.catChild item=list}
                                    <li {if $list.cat_id eq $spec_attr.cat_id} class="current"{/if}><a href="javascript:void(0);" data-value="{$list.cat_id}">{$list.cat_name}</a></li>
                                    {/foreach}
                                </ul>
                                <input name="" value="{$spec_attr.cat_id}" type="hidden" id='cat_id_val1'/>
                            </div>
                            {/if}
                        </div>
                        {if $mode eq 'homeFloorFour' || $mode eq 'homeFloorFive' || $mode eq 'homeFloorSeven' || $mode eq 'homeFloorSix'}
                        <input name="top_goods" type="hidden" value='{$spec_attr.top_goods}'/>
                        <a href="javascript:void(0);" class="hdle" ectype="setupGoods" data-top='1' data-goodsnumber="{if $mode eq 'homeFloorSeven'}6{else}12{/if}">设置商品</a>
                        {/if}
                    </div>
                    <input name="Floorcat_id" type="hidden" value='{$spec_attr.cat_id}'/>
                </div>
                <div class="control_item">
                    <div class="control_text lh30">楼层二级分类：</div>
                    <div class="control_value" data-catnumber="{if $mode eq 'homeFloorModule'}2{else}6{/if}" data-goodsnumber="{if $mode eq 'homeFloorModule'}4{else}12{/if}">
                        {if $spec_attr.juniorCat}
                            {foreach from=$spec_attr.catInfo item=value name=name}
                            <div class="item" ectype="item">
                                <div class="imitate_select select_w220" ectype="iselectErji">
                                    <div class="cite erji" ectype="tit">请选择</div>
                                    <ul>
                                        <li><a href="javascript:void(0);" data-value="">请选择..</a></li>
                                        {foreach from=$spec_attr.juniorCat item=list}
                                        <li{if $list.cat_id eq $value.cat_id} class="current"{/if}><a href="javascript:void(0);" data-value="{$list.cat_id}">{$list.cat_name}</a></li>
                                        {/foreach}
                                    </ul>
                                    <input name="cateValue[]" type="hidden" value="{$value.cat_id}" ectype="cateValue" />
                                </div>
                                {if $smarty.foreach.name.first}
                                <a href="javascript:void(0);" class="hdle" ectype="addCate">增加分类</a>
                                {/if}
                                <a href="javascript:void(0);" class="hdle" ectype="setupGoods">
                                    设置商品
                                    <input type="hidden" name="cat_goods[]" value="{$value.cat_goods}">
                                </a>
                                {if !$smarty.foreach.name.first}
                                <a href="javascript:void(0);" class="hdle" ectype="removeCate">删除分类</a>
                                {/if}
                            </div>
                            {/foreach}
                        {else}
                        <div class="item" ectype="item">
                            <div class="imitate_select select_w220" ectype="iselectErji">
                                <div class="cite" ectype="tit">请选择</div>
                                <ul>
                                    <li><a href="javascript:void(0);" data-value="">请选择..</a></li>
                                </ul>
                                <input name="cateValue[]" type="hidden" value="" ectype="cateValue" />
                            </div>
                            <a href="javascript:void(0);" class="hdle" ectype="addCate">增加分类</a>
                            <a href="javascript:void(0);" class="hdle" ectype="setupGoods" style="display:none;">
                                设置商品
                                <input type="hidden" name="cat_goods[]" value="">
                            </a>
                        </div>
                        {/if}
                    </div>
                </div>
                <div class="control_item">
                    <div class="control_text lh30">设置颜色：</div>
                    <div class="control_value">
                        <div class="color-item color-item1{if $spec_attr.typeColor eq 'floor-color-type-1' || !$spec_attr.typeColor} selected{/if}" ectype="colorItem">
                            <input type="hidden" value="floor-color-type-1">
                            <i></i>
                        </div>
                        <div class="color-item color-item2{if $spec_attr.typeColor eq 'floor-color-type-2'} selected{/if}" ectype="colorItem">
                            <input type="hidden" name="" value="floor-color-type-2">
                            <i></i>
                        </div>
                        <div class="color-item color-item3{if $spec_attr.typeColor eq 'floor-color-type-3'} selected{/if}" ectype="colorItem">
                            <input type="hidden" name="" value="floor-color-type-3">
                            <i></i>
                        </div>
                        <div class="color-item color-item4{if $spec_attr.typeColor eq 'floor-color-type-4'} selected{/if}" ectype="colorItem">
                            <input type="hidden" name="" value="floor-color-type-4">
                            <i></i>
                        </div>
                        <div class="color-item color-item5{if $spec_attr.typeColor eq 'floor-color-type-5'} selected{/if}" ectype="colorItem">
                            <input type="hidden" name="" value="floor-color-type-5">
                            <i></i>
                        </div>
                        <div class="color-item color-item6{if $spec_attr.typeColor eq 'floor-color-type-6'} selected{/if}" ectype="colorItem">
                            <input type="hidden" name="" value="floor-color-type-6">
                            <i></i>
                        </div>
                        <div class="color-item color-item7{if $spec_attr.typeColor eq 'floor-color-type-7'} selected{/if}" ectype="colorItem">
                            <input type="hidden" name="" value="floor-color-type-7">
                            <i></i>
                        </div>
                        <div class="color-item color-item8{if $spec_attr.typeColor eq 'floor-color-type-8'} selected{/if}" ectype="colorItem">
                            <input type="hidden" name="" value="floor-color-type-8">
                            <i></i>
                        </div>
                        <div class="color-item color-item9{if $spec_attr.typeColor eq 'floor-color-type-9'} selected{/if}" ectype="colorItem">
                            <input type="hidden" name="" value="floor-color-type-9">
                            <i></i>
                        </div>
                        <div class="color-item color-item10{if $spec_attr.typeColor eq 'floor-color-type-10'} selected{/if}" ectype="colorItem">
                            <input type="hidden" name="" value="floor-color-type-10">
                            <i></i>
                        </div>
                        <div class="color-item color-item11{if $spec_attr.typeColor eq 'floor-color-type-11'} selected{/if}" ectype="colorItem">
                            <input type="hidden" name="" value="floor-color-type-11">
                            <i></i>
                        </div>
                        <div class="color-item color-item12{if $spec_attr.typeColor eq 'floor-color-type-12'} selected{/if}" ectype="colorItem">
                            <input type="hidden" name="" value="floor-color-type-12">
                            <i></i>
                        </div>
                        <div class="color-item color-item13{if $spec_attr.typeColor eq 'floor-color-type-13'} selected{/if}" ectype="colorItem">
                            <input type="hidden" name="" value="floor-color-type-13">
                            <i></i>
                        </div>
                        <div class="color-item color-item14{if $spec_attr.typeColor eq 'floor-color-type-14'} selected{/if}" ectype="colorItem">
                            <input type="hidden" name="" value="floor-color-type-14">
                            <i></i>
                        </div>
                        
                        <div class="color-item color-item15{if $spec_attr.typeColor eq 'floor-color-type-15'} selected{/if}" ectype="colorItem">
                            <input type="hidden" name="" value="floor-color-type-15">
                            <i></i>
                        </div>
                        <div class="color-item color-item16{if $spec_attr.typeColor eq 'floor-color-type-16'} selected{/if}" ectype="colorItem">
                            <input type="hidden" name="" value="floor-color-type-16">
                            <i></i>
                        </div>
                        <div class="color-item color-item17{if $spec_attr.typeColor eq 'floor-color-type-17'} selected{/if}" ectype="colorItem">
                            <input type="hidden" name="" value="floor-color-type-17">
                            <i></i>
                        </div>
                        <div class="color-item color-item18{if $spec_attr.typeColor eq 'floor-color-type-18'} selected{/if}" ectype="colorItem">
                            <input type="hidden" name="" value="floor-color-type-18">
                            <i></i>
                        </div>
                        
                        <div class="color-item color-item19{if $spec_attr.typeColor eq 'floor-color-type-19'} selected{/if}" ectype="colorItem">
                            <input type="hidden" name="" value="floor-color-type-19">
                            <i></i>
                        </div>
                        <div class="color-item color-item20{if $spec_attr.typeColor eq 'floor-color-type-20'} selected{/if}" ectype="colorItem">
                            <input type="hidden" name="" value="floor-color-type-20">
                            <i></i>
                        </div>
                        <div class="color-item color-item21{if $spec_attr.typeColor eq 'floor-color-type-21'} selected{/if}" ectype="colorItem">
                            <input type="hidden" name="" value="floor-color-type-21">
                            <i></i>
                        </div>
                        <div class="color-item color-item22{if $spec_attr.typeColor eq 'floor-color-type-22'} selected{/if}" ectype="colorItem">
                            <input type="hidden" name="" value="floor-color-type-22">
                            <i></i>
                        </div>
                        
                        <div class="color-item color-item23{if $spec_attr.typeColor eq 'floor-color-type-23'} selected{/if}" ectype="colorItem">
                            <input type="hidden" name="" value="floor-color-type-23">
                            <i></i>
                        </div>
                        <div class="color-item color-item24{if $spec_attr.typeColor eq 'floor-color-type-24'} selected{/if}" ectype="colorItem">
                            <input type="hidden" name="" value="floor-color-type-24">
                            <i></i>
                        </div>
                        <div class="color-item color-item25{if $spec_attr.typeColor eq 'floor-color-type-25'} selected{/if}" ectype="colorItem">
                            <input type="hidden" name="" value="floor-color-type-25">
                            <i></i>
                        </div>
                        <div class="color-item color-item26{if $spec_attr.typeColor eq 'floor-color-type-26'} selected{/if}" ectype="colorItem">
                            <input type="hidden" name="" value="floor-color-type-26">
                            <i></i>
                        </div>
                        <input type="hidden" name="typeColor" value="{if $spec_attr.typeColor}{$spec_attr.typeColor}{else}floor-color-type-1{/if}">
                    </div>
                </div>
            </div>
        </div>
        <div class="body_info" style="display:none;">
            <div class="control_list">
                <div class="control_item control_item_quan">
                    <div class="control_value">
                        <div class="floormodeItem{if $mode eq 'homeFloorModule'} floormodeModuleItem{/if}{if $spec_attr.floorMode lt 2} selected{/if}" ectype="floormodeItem">
                        	<div class="img"><img src="images/visual/{$mode}_01.jpg"></div>
                            <div class="checkbox_item">
                            	<input type="radio" name="floorMode" value="1" data-pattern="{$floor_style.0}" class="ui-radio" id="floorMode_1"{if $spec_attr.floorMode lt 2} checked{/if}/>
                            	<label class="ui-radio-label" for="floorMode_1">楼层广告模板一</label>
                            </div>
                            <div ectype="floorModehide" class="hide">
                                {if $spec_attr.floorMode eq 1}
                                <div ectype="leftBanner">
                                    {foreach from=$spec_attr.leftBanner item=item}
                                    <input name="leftBanner[]" type="hidden" value="{$item}">
                                    {/foreach}
                                    {foreach from=$spec_attr.leftBannerLink item=item}
                                    <input name="leftBannerLink[]" type="hidden" value="{$item}">
                                    {/foreach}   
                                    {foreach from=$spec_attr.leftBannerSort item=item}
                                    <input name="leftBannerSort[]" type="hidden" value="{$item}">
                                    {/foreach}   
                                    <div ectype="advimg">
                                        {foreach from=$spec_attr.leftBanner item=item}
                                        {if $item}<a href="{$item}" class="nyroModal" target="_blank"><i class="iconfont icon-image" onmouseover="toolTip('<img src={$item}>')" onmouseout="toolTip()"></i></a>{/if}
                                        {/foreach}
                                    </div>
                                </div>
                                <div ectype="leftAdv">
                                    {foreach from=$spec_attr.leftAdv item=item}
                                    <input name="leftAdv[]" type="hidden" value="{$item}">
                                    {/foreach}

                                    {foreach from=$spec_attr.leftAdvLink item=item}
                                    <input name="leftAdvLink[]" type="hidden" value="{$item}">
                                    {/foreach}   

                                    {foreach from=$spec_attr.leftAdvSort item=item}
                                    <input name="leftAdvSort[]" type="hidden" value="{$item}">
                                    {/foreach} 
                                    <div ectype="advimg">
                                        {foreach from=$spec_attr.leftAdv item=item}
                                        {if $item}<a href="{$item}" class="nyroModal" target="_blank"><i class="iconfont icon-image" onmouseover="toolTip('<img src={$item}>')" onmouseout="toolTip()"></i></a>{/if}
                                        {/foreach}
                                    </div>
                                </div>
                                <div ectype="rightAdv">
                                    {foreach from=$spec_attr.rightAdv item=item}
                                    <input name="rightAdv[]" type="hidden" value="{$item}">
                                    {/foreach}

                                    {foreach from=$spec_attr.rightAdvLink item=item}
                                    <input name="rightAdvLink[]" type="hidden" value="{$item}">
                                    {/foreach}   

                                    {foreach from=$spec_attr.rightAdvSort item=item}
                                    <input name="rightAdvSort[]" type="hidden" value="{$item}">
                                    {/foreach}  

                                    {foreach from=$spec_attr.rightAdvTitle item=item}
                                    <input name="rightAdvTitle[]" type="hidden" value="{$item}">
                                    {/foreach}   

                                    {foreach from=$spec_attr.rightAdvSubtitle item=item}
                                    <input name="rightAdvSubtitle[]" type="hidden" value="{$item}">
                                    {/foreach} 
                                    <div ectype="advimg">
                                        {foreach from=$spec_attr.rightAdv item=item}
                                        {if $item}<a href="{$item}" class="nyroModal" target="_blank"><i class="iconfont icon-image" onmouseover="toolTip('<img src={$item}>')" onmouseout="toolTip()"></i></a>{/if}
                                        {/foreach}
                                    </div>
                                </div>
                                {else}
                                <div ectype="leftBanner">
                                    <div ectype="advimg">
                                    </div>
                                </div>
                                <div ectype="leftAdv">
                                    <div ectype="advimg">
                                    </div>
                                </div>
                                <div ectype="rightAdv">
                                    <div ectype="advimg">
                                    </div>
                                </div>
                                {/if}
                            </div>   
                        </div>
                        <div class="floormodeItem{if $mode eq 'homeFloorModule'} floormodeModuleItem{/if}{if $spec_attr.floorMode eq 2} selected{/if}" ectype="floormodeItem">
                        	<div class="img"><img src="images/visual/{$mode}_02.jpg"></div>
                            <div class="checkbox_item">
                            	<input type="radio" name="floorMode" value="2" data-pattern="{$floor_style.1}" class="ui-radio" id="floorMode_2"{if $spec_attr.floorMode eq 2} checked{/if} />
                            	<label class="ui-radio-label" for="floorMode_2">楼层广告模板二</label>
                            </div>
                            <div ectype="floorModehide" class="hide">
                                {if $spec_attr.floorMode eq 2}
                                <div ectype="leftBanner">
                                    {foreach from=$spec_attr.leftBanner item=item}
                                    <input name="leftBanner[]" type="hidden" value="{$item}">
                                    {/foreach}
                                    {foreach from=$spec_attr.leftBannerLink item=item}
                                    <input name="leftBannerLink[]" type="hidden" value="{$item}">
                                    {/foreach}   
                                    {foreach from=$spec_attr.leftBannerSort item=item}
                                    <input name="leftBannerSort[]" type="hidden" value="{$item}">
                                    {/foreach}   
                                    <div ectype="advimg">
                                        {foreach from=$spec_attr.leftBanner item=item}
                                        {if $item}<a href="{$item}" class="nyroModal" target="_blank"><i class="iconfont icon-image" onmouseover="toolTip('<img src={$item}>')" onmouseout="toolTip()"></i></a>{/if}
                                        {/foreach}
                                    </div>
                                </div>
                                <div ectype="leftAdv">
                                    {foreach from=$spec_attr.leftAdv item=item}
                                    <input name="leftAdv[]" type="hidden" value="{$item}">
                                    {/foreach}

                                    {foreach from=$spec_attr.leftAdvLink item=item}
                                    <input name="leftAdvLink[]" type="hidden" value="{$item}">
                                    {/foreach}   

                                    {foreach from=$spec_attr.leftAdvSort item=item}
                                    <input name="leftAdvSort[]" type="hidden" value="{$item}">
                                    {/foreach} 
                                    <div ectype="advimg">
                                        {foreach from=$spec_attr.leftAdv item=item}
                                        {if $item}<a href="{$item}" class="nyroModal" target="_blank"><i class="iconfont icon-image" onmouseover="toolTip('<img src={$item}>')" onmouseout="toolTip()"></i></a>{/if}
                                        {/foreach}
                                    </div>
                                </div>
                                <div ectype="rightAdv">
                                    {foreach from=$spec_attr.rightAdv item=item}
                                    <input name="rightAdv[]" type="hidden" value="{$item}">
                                    {/foreach}

                                    {foreach from=$spec_attr.rightAdvLink item=item}
                                    <input name="rightAdvLink[]" type="hidden" value="{$item}">
                                    {/foreach}   

                                    {foreach from=$spec_attr.rightAdvSort item=item}
                                    <input name="rightAdvSort[]" type="hidden" value="{$item}">
                                    {/foreach}  

                                    {foreach from=$spec_attr.rightAdvTitle item=item}
                                    <input name="rightAdvTitle[]" type="hidden" value="{$item}">
                                    {/foreach}   

                                    {foreach from=$spec_attr.rightAdvSubtitle item=item}
                                    <input name="rightAdvSubtitle[]" type="hidden" value="{$item}">
                                    {/foreach} 
                                    <div ectype="advimg">
                                        {foreach from=$spec_attr.rightAdv item=item}
                                        {if $item}<a href="{$item}" class="nyroModal" target="_blank"><i class="iconfont icon-image" onmouseover="toolTip('<img src={$item}>')" onmouseout="toolTip()"></i></a>{/if}
                                        {/foreach}
                                    </div>
                                </div>
                                {else}
                                <div ectype="leftBanner">
                                    <div ectype="advimg">
                                    </div>
                                </div>
                                <div ectype="leftAdv">
                                    <div ectype="advimg">
                                    </div>
                                </div>
                                <div ectype="rightAdv">
                                    <div ectype="advimg">
                                    </div>
                                </div>
                                {/if}
                            </div>
                        </div>
                        <div class="floormodeItem{if $mode eq 'homeFloorModule'} floormodeModuleItem{/if}{if $spec_attr.floorMode eq 3} selected{/if}" ectype="floormodeItem">
                        	<div class="img"><img src="images/visual/{$mode}_03.jpg"></div>
                            <div class="checkbox_item">
                            	<input type="radio" name="floorMode" value="3" data-pattern="{$floor_style.2}" class="ui-radio" id="floorMode_3"{if $spec_attr.floorMode eq 3} checked{/if}/>
                            	<label class="ui-radio-label" for="floorMode_3">楼层广告模板三</label>
                            </div>
                            <div ectype="floorModehide" class="hide">
                                {if $spec_attr.floorMode eq 3}
                                <div ectype="leftBanner">
                                    {foreach from=$spec_attr.leftBanner item=item}
                                    <input name="leftBanner[]" type="hidden" value="{$item}">
                                    {/foreach}
                                    {foreach from=$spec_attr.leftBannerLink item=item}
                                    <input name="leftBannerLink[]" type="hidden" value="{$item}">
                                    {/foreach}   
                                    {foreach from=$spec_attr.leftBannerSort item=item}
                                    <input name="leftBannerSort[]" type="hidden" value="{$item}">
                                    {/foreach}   
                                    <div ectype="advimg">
                                        {foreach from=$spec_attr.leftBanner item=item}
                                        {if $item}<a href="{$item}" class="nyroModal" target="_blank"><i class="iconfont icon-image" onmouseover="toolTip('<img src={$item}>')" onmouseout="toolTip()"></i></a>{/if}
                                        {/foreach}
                                    </div>
                                </div>
                                <div ectype="leftAdv">
                                    {foreach from=$spec_attr.leftAdv item=item}
                                    <input name="leftAdv[]" type="hidden" value="{$item}">
                                    {/foreach}

                                    {foreach from=$spec_attr.leftAdvLink item=item}
                                    <input name="leftAdvLink[]" type="hidden" value="{$item}">
                                    {/foreach}   

                                    {foreach from=$spec_attr.leftAdvSort item=item}
                                    <input name="leftAdvSort[]" type="hidden" value="{$item}">
                                    {/foreach} 
                                    <div ectype="advimg">
                                        {foreach from=$spec_attr.leftAdv item=item}
                                        {if $item}<a href="{$item}" class="nyroModal" target="_blank"><i class="iconfont icon-image" onmouseover="toolTip('<img src={$item}>')" onmouseout="toolTip()"></i></a>{/if}
                                        {/foreach}
                                    </div>
                                </div>
                                <div ectype="rightAdv">
                                    {foreach from=$spec_attr.rightAdv item=item}
                                    <input name="rightAdv[]" type="hidden" value="{$item}">
                                    {/foreach}

                                    {foreach from=$spec_attr.rightAdvLink item=item}
                                    <input name="rightAdvLink[]" type="hidden" value="{$item}">
                                    {/foreach}   

                                    {foreach from=$spec_attr.rightAdvSort item=item}
                                    <input name="rightAdvSort[]" type="hidden" value="{$item}">
                                    {/foreach}  

                                    {foreach from=$spec_attr.rightAdvTitle item=item}
                                    <input name="rightAdvTitle[]" type="hidden" value="{$item}">
                                    {/foreach}   

                                    {foreach from=$spec_attr.rightAdvSubtitle item=item}
                                    <input name="rightAdvSubtitle[]" type="hidden" value="{$item}">
                                    {/foreach} 
                                    <div ectype="advimg">
                                        {foreach from=$spec_attr.rightAdv item=item}
                                        {if $item}<a href="{$item}" class="nyroModal" target="_blank"><i class="iconfont icon-image" onmouseover="toolTip('<img src={$item}>')" onmouseout="toolTip()"></i></a>{/if}
                                        {/foreach}
                                    </div>
                                </div>
                                {else}
                                <div ectype="leftBanner">
                                    <div ectype="advimg">
                                    </div>
                                </div>
                                <div ectype="leftAdv">
                                    <div ectype="advimg">
                                    </div>
                                </div>
                                <div ectype="rightAdv">
                                    <div ectype="advimg">
                                    </div>
                                </div>
                                {/if}
                            </div>
                        </div>
                        <div class="floormodeItem{if $mode eq 'homeFloorModule'} floormodeModuleItem{/if}{if $spec_attr.floorMode eq 4} selected{/if} last" ectype="floormodeItem">
                        	<div class="img"><img src="images/visual/{$mode}_04.jpg"></div>
                            <div class="checkbox_item">
                            	<input type="radio" name="floorMode" value="4" class="ui-radio" data-pattern="{$floor_style.3}" id="floorMode_4"{if $spec_attr.floorMode eq 4} checked{/if}/>
                            	<label class="ui-radio-label" for="floorMode_4">楼层广告模板四</label>
                            </div>
                            <div ectype="floorModehide" class="hide">
                                {if $spec_attr.floorMode eq 4}
                                <div ectype="leftBanner">
                                    {foreach from=$spec_attr.leftBanner item=item}
                                    <input name="leftBanner[]" type="hidden" value="{$item}">
                                    {/foreach}
                                    {foreach from=$spec_attr.leftBannerLink item=item}
                                    <input name="leftBannerLink[]" type="hidden" value="{$item}">
                                    {/foreach}   
                                    {foreach from=$spec_attr.leftBannerSort item=item}
                                    <input name="leftBannerSort[]" type="hidden" value="{$item}">
                                    {/foreach}   
                                    <div ectype="advimg">
                                        {foreach from=$spec_attr.leftBanner item=item}
                                        {if $item}<a href="{$item}" class="nyroModal" target="_blank"><i class="iconfont icon-image" onmouseover="toolTip('<img src={$item}>')" onmouseout="toolTip()"></i></a>{/if}
                                        {/foreach}
                                    </div>
                                </div>
                                <div ectype="leftAdv">
                                    {foreach from=$spec_attr.leftAdv item=item}
                                    <input name="leftAdv[]" type="hidden" value="{$item}">
                                    {/foreach}

                                    {foreach from=$spec_attr.leftAdvLink item=item}
                                    <input name="leftAdvLink[]" type="hidden" value="{$item}">
                                    {/foreach}   

                                    {foreach from=$spec_attr.leftAdvSort item=item}
                                    <input name="leftAdvSort[]" type="hidden" value="{$item}">
                                    {/foreach} 
                                    <div ectype="advimg">
                                        {foreach from=$spec_attr.leftAdv item=item}
                                        {if $item}<a href="{$item}" class="nyroModal" target="_blank"><i class="iconfont icon-image" onmouseover="toolTip('<img src={$item}>')" onmouseout="toolTip()"></i></a>{/if}
                                        {/foreach}
                                    </div>
                                </div>
                                <div ectype="rightAdv">
                                    {foreach from=$spec_attr.rightAdv item=item}
                                    <input name="rightAdv[]" type="hidden" value="{$item}">
                                    {/foreach}

                                    {foreach from=$spec_attr.rightAdvLink item=item}
                                    <input name="rightAdvLink[]" type="hidden" value="{$item}">
                                    {/foreach}   

                                    {foreach from=$spec_attr.rightAdvSort item=item}
                                    <input name="rightAdvSort[]" type="hidden" value="{$item}">
                                    {/foreach}  

                                    {foreach from=$spec_attr.rightAdvTitle item=item}
                                    <input name="rightAdvTitle[]" type="hidden" value="{$item}">
                                    {/foreach}   

                                    {foreach from=$spec_attr.rightAdvSubtitle item=item}
                                    <input name="rightAdvSubtitle[]" type="hidden" value="{$item}">
                                    {/foreach} 
                                    <div ectype="advimg">
                                        {foreach from=$spec_attr.rightAdv item=item}
                                        {if $item}<a href="{$item}" class="nyroModal" target="_blank"><i class="iconfont icon-image" onmouseover="toolTip('<img src={$item}>')" onmouseout="toolTip()"></i></a>{/if}
                                        {/foreach}
                                    </div>
                                </div>
                                {else}
                                <div ectype="leftBanner">
                                    <div ectype="advimg">
                                    </div>
                                </div>
                                <div ectype="leftAdv">
                                    <div ectype="advimg">
                                    </div>
                                </div>
                                <div ectype="rightAdv">
                                    <div ectype="advimg">
                                    </div>
                                </div>
                                {/if}
                            </div>
                        </div>
						{if $mode eq "homeFloorFive" || $mode eq "homeFloorSeven"}
                        <div class="floormodeItem{if $spec_attr.floorMode eq 5} selected{/if}" ectype="floormodeItem">
                            <div class="img"><img src="images/visual/{$mode}_05.jpg"></div>
                            <div class="checkbox_item">
                            	<input type="radio" name="floorMode" value="5" data-pattern="{$floor_style.4}" class="ui-radio" id="floorMode_5"{if $spec_attr.floorMode eq 5} checked{/if}/>
                            	<label class="ui-radio-label" for="floorMode_5">楼层广告模板五</label>
                            </div>
                            <div ectype="floorModehide" class="hide">
                                {if $spec_attr.floorMode eq 5}
                                <div ectype="leftBanner">
                                    {foreach from=$spec_attr.leftBanner item=item}
                                    <input name="leftBanner[]" type="hidden" value="{$item}">
                                    {/foreach}
                                    {foreach from=$spec_attr.leftBannerLink item=item}
                                    <input name="leftBannerLink[]" type="hidden" value="{$item}">
                                    {/foreach}   
                                    {foreach from=$spec_attr.leftBannerSort item=item}
                                    <input name="leftBannerSort[]" type="hidden" value="{$item}">
                                    {/foreach}   
                                    <div ectype="advimg">
                                        {foreach from=$spec_attr.leftBanner item=item}
                                        {if $item}<a href="{$item}" class="nyroModal" target="_blank"><i class="iconfont icon-image" onmouseover="toolTip('<img src={$item}>')" onmouseout="toolTip()"></i></a>{/if}
                                        {/foreach}
                                    </div>
                                </div>
                                <div ectype="leftAdv">
                                    {foreach from=$spec_attr.leftAdv item=item}
                                    <input name="leftAdv[]" type="hidden" value="{$item}">
                                    {/foreach}

                                    {foreach from=$spec_attr.leftAdvLink item=item}
                                    <input name="leftAdvLink[]" type="hidden" value="{$item}">
                                    {/foreach}   

                                    {foreach from=$spec_attr.leftAdvSort item=item}
                                    <input name="leftAdvSort[]" type="hidden" value="{$item}">
                                    {/foreach} 
                                    <div ectype="advimg">
                                        {foreach from=$spec_attr.leftAdv item=item}
                                        {if $item}<a href="{$item}" class="nyroModal" target="_blank"><i class="iconfont icon-image" onmouseover="toolTip('<img src={$item}>')" onmouseout="toolTip()"></i></a>{/if}
                                        {/foreach}
                                    </div>
                                </div>
                                <div ectype="rightAdv">
                                    {foreach from=$spec_attr.rightAdv item=item}
                                    <input name="rightAdv[]" type="hidden" value="{$item}">
                                    {/foreach}

                                    {foreach from=$spec_attr.rightAdvLink item=item}
                                    <input name="rightAdvLink[]" type="hidden" value="{$item}">
                                    {/foreach}   

                                    {foreach from=$spec_attr.rightAdvSort item=item}
                                    <input name="rightAdvSort[]" type="hidden" value="{$item}">
                                    {/foreach}  

                                    {foreach from=$spec_attr.rightAdvTitle item=item}
                                    <input name="rightAdvTitle[]" type="hidden" value="{$item}">
                                    {/foreach}   

                                    {foreach from=$spec_attr.rightAdvSubtitle item=item}
                                    <input name="rightAdvSubtitle[]" type="hidden" value="{$item}">
                                    {/foreach} 
                                    <div ectype="advimg">
                                        {foreach from=$spec_attr.rightAdv item=item}
                                        {if $item}<a href="{$item}" class="nyroModal" target="_blank"><i class="iconfont icon-image" onmouseover="toolTip('<img src={$item}>')" onmouseout="toolTip()"></i></a>{/if}
                                        {/foreach}
                                    </div>
                                </div>
                                {else}
                                <div ectype="leftBanner">
                                    <div ectype="advimg">
                                    </div>
                                </div>
                                <div ectype="leftAdv">
                                    <div ectype="advimg">
                                    </div>
                                </div>
                                <div ectype="rightAdv">
                                    <div ectype="advimg">
                                    </div>
                                </div>
                                {/if}
                            </div>
                        </div>
						{/if}
                    </div>
                </div>
                <div class="control_item control_item_cent" ectype="floorMode">
                    <div class="control_text lh30"><span class="cor cor1"></span>轮播广告图：</div>
                    <div class="control_value lh30" ectype="imgControl">
                        <a href="javascript:void(0);" class="blue fl" ectype="uploadImage" data-uploadimagetype="home" data-title="轮播广告图"  data-number="{if $mode eq 'homeFloorThree'}5{else}3{/if}">选择上传图片</a>
                        <div class="imgup_icon" ectype="imgValue" data-name="leftBanner">
                            {foreach from=$spec_attr.leftBanner item=item}
                            {if $item}<a href="{$item}" class="nyroModal" target="_blank"><i class="iconfont icon-image" onmouseover="toolTip('<img src={$item}>')" onmouseout="toolTip()"></i></a>{/if}
                            {/foreach}
                        </div>
                    </div>
                </div>
               	
                <div class="control_item control_item_cent" ectype="floorMode">
                    <div class="control_text lh30"><span class="cor cor2"></span>普通广告图：</div>
                    <div class="control_value lh30" ectype="imgControl">
                        <a href="javascript:void(0);" class="blue fl" ectype="uploadImage" data-uploadimagetype="home" data-title="普通广告图" data-number="2">选择上传图片</a>
                        <div class="imgup_icon" ectype="imgValue" data-name="leftAdv">
                            {foreach from=$spec_attr.leftAdv item=item}
                            {if $item}<a href="{$item}" class="nyroModal" target="_blank"><i class="iconfont icon-image" onmouseover="toolTip('<img src={$item}>')" onmouseout="toolTip()"></i></a>{/if}
                            {/foreach}
                        </div>
                    </div>
                </div>
                
                <div class="control_item control_item_cent" ectype="floorMode">
                    <div class="control_text lh30"><span class="cor cor3"></span>标题广告图：</div>
                    <div class="control_value lh30" ectype="imgControl">
                        <a href="javascript:void(0);" class="blue fl" ectype="uploadImage" data-uploadimagetype="home" data-title="标题广告图" {if $mode neq 'homeFloorFour' && $mode neq 'homeFloorSix'}data-titleup="1"{/if} data-number="{if $mode eq 'homeFloor'}5{elseif $mode eq 'homeFloorFour' || $mode eq 'homeFloorFive'}3{elseif $mode eq 'homeFloorSix'}2{elseif $mode eq 'homeFloorSeven'}1{else}4{/if}">选择上传图片</a>
                        <div class="imgup_icon" ectype="imgValue" data-name="rightAdv">
                            {foreach from=$spec_attr.rightAdv item=item}
                            {if $item}<a href="{$item}" class="nyroModal" target="_blank"><i class="iconfont icon-image" onmouseover="toolTip('<img src={$item}>')" onmouseout="toolTip()"></i></a>{/if}
                            {/foreach}
                        </div>
                    </div>
                </div>    
            </div>        
        </div>
        <div class="body_info" style="display:none;">
            <div class="control_item">
                <div class="checkobx-item">
                    <input type="checkbox" id="selected_brand" name="is_selected" class="ui-checkbox fl" onclick="selected_brands(this)">
                    <label class="ui-label" for="selected_brand">已选择品牌</label>
                </div>
            </div>
            <div class="brand_list" ectype='brand_list' data-bandnumber="{if $mode eq 'homeFloorModule'}5{/if}">
            	<div class="notic">请先现在楼层一级分类或者该分类下暂无品牌</div>
            </div>
        </div>
    </div>
    <input type="hidden" name="mode" value="{$mode}">
    <input name='brand_ids' type='hidden' value='{$spec_attr.brand_ids}'>
</form>
<script type="text/javascript">
    var mode = "{$mode}";
    if(mode != 'homeFloorFive'){
        $(function(){
            var cat_id = $("input[name='Floorcat_id']").val();
            var brand_ids = $("input[name='brand_ids']").val();
            if(cat_id > 0){
                searchFloorBrand(cat_id,brand_ids);
            }
        })
    }
    
    function selected_brands(obj){
        var brand_ids = $("input[name='brand_ids']").val();
        var cat_id = $("input[name='Floorcat_id']").val();
        if(cat_id > 0){
            var is_selected =$("input[name='is_selected']").is(':checked');
            if(is_selected){
                is_selected = 1;
            }else{
                is_selected = 0;
            }
            searchFloorBrand(cat_id,brand_ids,is_selected);
        }
    }
    //select下拉默认值赋值
    $('.imitate_select').each(function(){
		var sel_this = $(this)
		var val = sel_this.children('input[type=hidden]').val();
		sel_this.find('a').each(function(){
			if($(this).attr('data-value') == val){
				sel_this.children('.cite').html($(this).html());
			}
		})
    });
	
    $.divselect("#cat_id","#cat_id_val",function(obj){
        var val = obj.attr("data-value");
        $("input[name='Floorcat_id']").val(val);
        getChildCat(val,1);
    });
	
    $.divselect("#cat_id1","#cat_id_val1",function(obj){
        var val = obj.attr("data-value");
        $("input[name='Floorcat_id']").val(val);
        getChildCat(val,2);
    });
	
    function getChildCat(cat_id,type){
    	if(type == 1){var type2 = 2}else if(type == 2){var type2 = 3}
        Ajax.call('index.php?con=visual_editing&fun=getChildCat', 'act=getChildCat&cat_id=' + cat_id +'&deep=' + type2, function(result){
            if(type == 1){
                $(".cat_floor").html(result.content);
            }
        
            $("*[ectype='addCate']").parents(".item").find("ul").html(result.contentChild);
            $("*[ectype='addCate']").parents(".item").find(".cite").html("请选择..");
            $("*[ectype='addCate']").parents(".item").find("input[type='hidden']").val("");
            $("*[ectype='addCate']").parents(".item").siblings().remove();
            if(mode != 'homeFloorFive'){
                searchFloorBrand(cat_id);
            }
            
            if(result.content == "" && type2 == 3){
           
                $(".erji").html(result.contentChild);
            }               
        }, 'POST', 'JSON');
    }
	
	function searchFloorBrand(cat_id,brand_ids,is_selected){
		Ajax.call('index.php?con=visual_editing&fun=filter_list', 'is_ajax=1&act=filter_list&search_type=get_content&FloorBrand=1&cat_id=' + cat_id + "&brand_ids=" + brand_ids + "&is_selected=" + is_selected, function(result){
		   $("*[ectype='brand_list']").html(result.FloorBrand);
		}, 'POST', 'JSON');
	}
		
	//楼层广告模板选择
	$.divselect("#fm-select","#floorMode",function(obj){
        var val = obj.attr("data-value");
		var nyroModal = obj.parents("*[ectype='iselect']").siblings(".nyroModal");
        
		for(var i = 1; i < 9; i++){
			if(val == i){
				nyroModal.attr("href","images/visual/homeFloor_0" + i + ".jpg");
				nyroModal.find("i").attr("onmouseover","toolTip('<img src=images/visual/homeFloor_0" + i + ".jpg>')");
			}
		}
    });
	
	//判断模板模式选中后图片选择
	$(document).on("click","*[ectype='floormodeItem']",function(){
		var val = $(this).find("input[type='radio']").val(),
			pattern = $(this).find("input[type='radio']").data("pattern"),
			arr = new Array(),
			imgNumberArr = {$imgNumberArr};
			
		$(this).addClass("selected").siblings().removeClass("selected");
		$(this).find("input[type='radio']").prop("checked",true);
		
		pattern = pattern.toString();
		
		if(pattern.indexOf(',') > 0){
			arr = pattern.split(',');
		}else{
			arr = pattern;
		}

		$("*[ectype='floorMode']").hide();
		
		for(var i = 0; i<arr.length;i++){
			$("*[ectype='floorMode']").eq((arr[i]-1)).show();
		}
		
		for(var i in imgNumberArr){
			if(i == val){
				$.each(imgNumberArr[i],function(index,value){
					$("[data-name='"+index+"']").siblings("*[ectype='uploadImage']").attr("data-number",value);
				});
			}
		}
		var _this = $(this);
		$("*[ectype='imgValue']").each(function(){
			var name = $(this).data("name");
			var imgHtml = _this.find("[ectype='" + name + "']").find("[ectype='advimg']").html();
			$(this).html(imgHtml);
		});
	});
	
	//默认编辑弹框时模板模式选中
	var radioVal = $("input[name='floorMode']:checked").val();
	$("#floorMode_"+ radioVal).click();
</script>
{/if}
<script type="text/javascript">
	pbct();

	$(".table_list").perfectScrollbar("destroy");
	$(".table_list").perfectScrollbar();
	
	$(".ps_table").perfectScrollbar("destroy");
	$(".ps_table").perfectScrollbar();
	
	$(".select-container").hover(function(){
		$(".select-list").perfectScrollbar("destroy");
		$(".select-list").perfectScrollbar();
	});
	
	$(document).click(function(e){
		//仿select
		if(e.target.className !='cite' && !$(e.target).parents("div").is(".imitate_select")){
			$('.imitate_select ul').hide();
		}
		
		//分类
		if(e.target.id !='category_name' && !$(e.target).parents("div").is(".select-container")){
			$('.categorySelect .select-container').hide();
		}
	});
</script>
{if $temp eq 'ylinks'}
<!--首页楼层-->
<form action="" id="{$mode}Insert" method="post" enctype="multipart/form-data" runat="server" >
    <div class="tab">
        <ul class="clearfix">
            <li class="current">友情链接设置</li>
        </ul>
    </div>
    <div class="modal-body hfloor">
        <div class="body_info">
    	    <div class="control_list">
                <div class="control_item">
                    <div class="control_item">
                        <div class="control_text"><em class="red">*</em>模块名称：</div>
                        <div class="control_value"><input type="text" value="{$lift}" class="text" name="lift" autocomplete="off" maxlength="4" placeholder="请填写标题" ectype="required" data-msg="请填写标题" /><div class="notic">模块名称是显示左侧友情链接；只能4个中文字符，如：合作商家</div></div>
                    </div>
                </div>   
            </div> 
            <div class="ps_table">
                <table id="addpictable" class="table">
                    <thead>
                        <tr>
                            <th>友情链接标题</th>
                          
                            <th>友情链接地址</th>
                  
                                

                         

                            <th class="center">操作</th>
                       </tr>
                    </thead>
                   <tbody>
                        {foreach from=$banner_list item=item key=k}
                            <tr>

                                    <td>
                                        <input type="text" name="links_title[]" value="{$item.links_title}" class="form-control">
                                    </td>
                                    <td>
                                        <input type="text" name="title[]" value="{$item.title}" class="form-control">
                                    </td>                                    



                                <td class="center">
                                    <a href="javascript:;" class="pic_del del">删除</a>
                                </td>
                            </tr>
                        {foreachelse}
                            <tr class="notic">
                                <td colspan="5">点击添加按钮，添加友情链接</td>
                            </tr>    
                        {/foreach}
                    </tbody>
                </table>
            </div>        
            
            <div class="images_space">
                <div class="goods_gallery mt20">
                    <div class="nav clearfix">
                    <div class="f_r mr5 add_links" ectype='add_links' onclick= "addlinks(this)"><i class="glyphicon"></i>添加友情链接</div>
                    </div>           
             </div>           
            <div class="control_list" style="padding-top: 30px;">                               
                <div class="control_item">
                    <div class="control_text lh30">设置颜色：</div>
                        <div class="page-head-bglink">

                            <input type="hidden" class="tm-picker-trigger-links" name="tm-picker-trigger-links" value="{$spec_attr.tm-picker-trigger-links}"  />
                            <input type="checkbox" class="ui-checkbox" name="header_dis_links" value="{$spec_attr.header_dis_links}" id="header_dis_links"  {if $spec_attr.header_dis_links eq 1}checked{/if} />
                            <label for="header_dis_links" class="ui-label">显示</label>
                        </div>
                </div>
            </div>
        </div>
    </div>
    <input type="hidden" name="mode" value="{$mode}">
</form>
<script type="text/javascript">
         //商品名称颜色设置
        $(".page-head-bglink .tm-picker-trigger-links").spectrum({
            showInitial: true,
            showPalette: true,
            showSelectionPalette: true,
            showInput: true,
            color: "#fff",
            showSelectionPalette: true,
            maxPaletteSize: 10,
            preferredFormat: "hex",
            palette: [
                ["rgb(0, 0, 0)", "rgb(67, 67, 67)", "rgb(102, 102, 102)",
                "rgb(204, 204, 204)", "rgb(217, 217, 217)","rgb(255, 255, 255)"],
                ["rgb(152, 0, 0)", "rgb(255, 0, 0)", "rgb(255, 153, 0)", "rgb(255, 255, 0)", "rgb(0, 255, 0)",
                "rgb(0, 255, 255)", "rgb(74, 134, 232)", "rgb(0, 0, 255)", "rgb(153, 0, 255)", "rgb(255, 0, 255)"], 
                ["rgb(230, 184, 175)", "rgb(244, 204, 204)", "rgb(252, 229, 205)", "rgb(255, 242, 204)", "rgb(217, 234, 211)", 
                "rgb(208, 224, 227)", "rgb(201, 218, 248)", "rgb(207, 226, 243)", "rgb(217, 210, 233)", "rgb(234, 209, 220)", 
                "rgb(221, 126, 107)", "rgb(234, 153, 153)", "rgb(249, 203, 156)", "rgb(255, 229, 153)", "rgb(182, 215, 168)", 
                "rgb(162, 196, 201)", "rgb(164, 194, 244)", "rgb(159, 197, 232)", "rgb(180, 167, 214)", "rgb(213, 166, 189)", 
                "rgb(204, 65, 37)", "rgb(224, 102, 102)", "rgb(246, 178, 107)", "rgb(255, 217, 102)", "rgb(147, 196, 125)", 
                "rgb(118, 165, 175)", "rgb(109, 158, 235)", "rgb(111, 168, 220)", "rgb(142, 124, 195)", "rgb(194, 123, 160)",
                "rgb(166, 28, 0)", "rgb(204, 0, 0)", "rgb(230, 145, 56)", "rgb(241, 194, 50)", "rgb(106, 168, 79)",
                "rgb(69, 129, 142)", "rgb(60, 120, 216)", "rgb(61, 133, 198)", "rgb(103, 78, 167)", "rgb(166, 77, 121)",
                "rgb(91, 15, 0)", "rgb(102, 0, 0)", "rgb(120, 63, 4)", "rgb(127, 96, 0)", "rgb(39, 78, 19)", 
                "rgb(12, 52, 61)", "rgb(28, 69, 135)", "rgb(7, 55, 99)", "rgb(32, 18, 77)", "rgb(76, 17, 48)"]
            ]
        });        
        //添加背景颜色
        $("input[name='header_dis_links']").click(function(){
			var style = $(this).parents(".li").data("style");
            var bgDiv = $(this).parents(".page-head-bg");
            var bgColor = bgDiv.find(".tm-picker-trigger-links").val();
            var  yesno = $(this).val();
            if(yesno == 0 ){
            	$(this).val('1');
            }else{
            	$(this).val('0');
            }
            if($(this).prop("checked") == true){
                $(".pc-page").find(".hd_bg").css({"background-color":bgColor});
            }else{
                $(".pc-page").find(".hd_bg").css({"background-color":"transparent"});
            }
			//generate(style);
        });   	
	function addlinks(obj){
		var i = 0;
		var mode = "{$mode}";
		var length = "8";
        var uploadImage = "{$uploadImage}";
		var titleup = "{$titleup}";
		var id = $(obj).parents(".pb").attr("id");
		$("#addpictable").find('tr').each(function(){
			i++
		});
		
		if($("#addpictable").find('tr.notic').length>0){
			i-=1;
		}

		if( length< i  && length != 0){
			alert("此模块最多可添加"+length+"个友情链接");
		}else{
				var html = '<tr><td><input type="text" name="links_title[]" value="" class="form-control"></td><td><input type="text" name="title[]" value="" class="form-control"></td><td class="center"><a href="javascript:;" class="pic_del del">删除</a></td></tr>';			
			if($("#addpictable").find(".notic").length>0){
				$("#addpictable").find(".notic").remove();
			}
			$("#addpictable").find("tbody").prepend(html);
		}
		
		pbct("#"+id);
	}
</script>
{/if}
{if $temp eq 'cmsnew'}
<form action="" id="{$mode}Insert" method="post" enctype="multipart/form-data" runat="server" >
    <div class="tishi">
		<div class="tishi_info">
		<p class="first">注意：1、弹出框鼠标移到头部可以拖动，以防笔记本小屏幕内容展示不全;</p>
	    <p>2、关联新闻/活动来源于资讯，没有新闻/活动请到资讯发布文章;</p>
	    </div>
	</div>
	<div class="tab">
		<ul class="clearfix">
	    	<li class="current">内容设置</li>
	    	<li>左侧轮播设置</li>
	    	<li>中部设置</li>
	    	<li>右侧设置</li>
	    </ul>
	</div>
    <div class="modal-body hfloor">
        <div class="body_info">
            <div class="control_list">
                <div class="control_item">
                    
                    <div class="control_item">
                        <div class="control_text"><em class="red">*</em>中部名称：</div>
                        <div class="control_value"><input type="text" value="{$spec_attr.lift}" class="text" name="lift" autocomplete="off" maxlength="4" placeholder="请填中部名称标题" ectype="required" data-msg="请填写中部名称标题" /><div class="notic">中部名称是显示今日头条修改；最多4个中文字符，如：今日头条</div></div>
                    </div>
                   
                    <div class="control_item">
                        <div class="control_text"><em class="red">*</em>右侧标题：</div>
                        <div class="control_value"><input type="text" value="{$spec_attr.floor_title}" class="text" name="floor_title" autocomplete="off" placeholder="右侧标题"  data-msg="右侧标题" /><div class="notic">右侧标题，是修改新闻/活动标题</div></div>
                    </div>
                </div>
            </div>
        </div>
        <div class="body_info" style="display:none;">
    	    <div class="ps_table">
                <table id="addpictable" class="table">
                    <thead>
                        <tr>
                            <th>新闻封面</th>
                          
                                <th>新闻链接</th>
                                <th>新闻标题</th>
                                

                         

                            <th class="center">操作</th>
                       </tr>
                    </thead>
                   <tbody>
                        {foreach from=$banner_list item=item key=k}
                            <tr>
                                <td>
                                    <div class="img">
                                        <span><img src="{$item.pic_src}"></span>
                                        <input type="hidden" name="pic_src[]" value="{$item.pic_src}"/>
                                    </div>
                                </td>
                                {if $uploadImage neq 1}
                                    <td>
                                        <input type="text" name="link[]" value="{$item.link}" class="form-control">
                                    </td>
                                    <td>
                                        <input type="text" name="title[]" value="{$item.title}" class="form-control">
                                    </td>                                    
                                        <input type="hidden" name="article_id[]" value="{$item.article_id}">
                                        <input type="hidden" name="cms_label[]" value="{$item.cms_label}">
                                        <input type="hidden" name="class_id[]" value="{$item.class_id}">
                                {/if}
                                {if $titleup eq 1}
                                    <td class="center">
                                        <input type="text" value="{$item.title}" name="title[]" class="form-control small">
                                    </td>
                                    <td class="center">
                                        <input type="text" value="{$item.subtitle}" name="subtitle[]" class="form-control small">
                                    </td>
                                {/if}
                                <td class="center">
                                    <a href="javascript:;" class="pic_del del">删除</a>
                                </td>
                            </tr>
                        {foreachelse}
                            <tr class="notic">
                                <td colspan="5">点击下列新闻，可选中最多五个新闻</td>
                            </tr>    
                        {/foreach}
                    </tbody>
                </table>
            </div>
            <div class="images_space">
                <div class="goods_gallery mt20">
                    <form  action="" id="gallery_pic" method="post"  enctype="multipart/form-data"  runat="server" >
                        <div class="nav clearfix">
                            <div class="f_l">
                                <div class="imitate_select select_w220" id="cmsnew_id">
                                    <div class="cite">请选择新闻分类...</div>
                                        <ul style="display: none;" class="ps-container" ectype="album_list_check">
                                            <li><a href="javascript:;" data-value="0" class="ftx-01">请选择...</a></li>
                                            {foreach from=$album_list item=list key=k}
                                                <li><a href="javascript:;" data-value="{$list.album_id}" class="ftx-01">{$list.album_mame}</a></li>
                                            {/foreach}
                                        </ul>
                                        <input name="cmsnew_id" type="hidden" value="{$album_id}" id="cmsnew_id_val">
                                </div>

                            </div>

                        </div>
                    </form>
                    <div class="table_list" ectype='cmsnew_list'>
                        <div class="gallery_album" data-act="get_cmsnew_pic" data-inid="cmsnew_list" data-url='visual_editing.php' data-where="sort_name={$filter.sort_name}&album_id={$filter.album_id}">
                            <ul class="ga-images-ul">
                                {foreach from=$pic_list item=pic_list}
                                    <li><a href="javascript:;" onclick="addpic('{$pic_list.pic_file}',this,'{$pic_list.url_cms}','{$pic_list.pic_title}','{$pic_list.article_id}','{$pic_list.class_id}','{$pic_list.label}')"><img src="{$pic_list.pic_file}"><span class="pixel">{$pic_list.pic_title}</span></a></li>
                                {foreachelse}
                                    <li class="notic">暂无新闻</li>
                                {/foreach}
                            </ul>
                            <div class="clear"></div>
                            {include file="library/lib_page.lbi"}
                        </div>
                    </div>
                </div>
            </div>
          	
        </div>	
        <div class="body_info" style="display:none;">
    	    <div class="ps_table">
                <table id="z_addpictable" class="table">
                    <thead>
                        <tr>
                            <th>新闻封面</th>
                          
                                <th>新闻链接</th>
                                <th>新闻标题</th>
                                

                         

                            <th class="center">操作</th>
                       </tr>
                    </thead>
                   <tbody>
                        {foreach from=$z_banner_list item=z_item key=z_k}
                            <tr>
                                <td>
                                    <div class="img">
                                        <span><img src="{$z_item.pic_src}"></span>
                                        <input type="hidden" name="z_pic_src[]" value="{$z_item.pic_src}"/>
                                    </div>
                                </td>
                                {if $z_uploadImage neq 1}
                                    <td>
                                        <input type="text" name="z_link[]" value="{$z_item.link}" class="form-control">
                                    </td>
                                    <td>
                                        <input type="text" name="z_title[]" value="{$z_item.title}" class="form-control">
                                    </td>                                    
                                        <input type="hidden" name="z_article_id[]" value="{$z_item.article_id}">
                                        <input type="hidden" name="z_cms_label[]" value="{$z_item.cms_label}">
                                        <input type="hidden" name="z_class_id[]" value="{$z_item.class_id}">
                                {/if}
                                {if $z_titleup eq 1}
                                    <td class="center">
                                        <input type="text" value="{$z_item.title}" name="z_title[]" class="form-control small">
                                    </td>
                                    <td class="center">
                                        <input type="text" value="{$z_item.subtitle}" name="z_subtitle[]" class="form-control small">
                                    </td>
                                {/if}
                                <td class="center">
                                    <a href="javascript:;" class="pic_del del">删除</a>
                                </td>
                            </tr>
                        {foreachelse}
                            <tr class="notic">
                                <td colspan="5">点击下列新闻，可选中最多五个新闻</td>
                            </tr>    
                        {/foreach}
                    </tbody>
                </table>
            </div>
            <div class="images_space">
                <div class="goods_gallery mt20">
                    <form  action="" id="gallery_pic" method="post"  enctype="multipart/form-data"  runat="server" >
                        <div class="nav clearfix">
                            <div class="f_l">
                                <div class="imitate_select select_w220" id="z_cmsnew_id">
                                    <div class="cite">请选择新闻分类...</div>
                                        <ul style="display: none;" class="ps-container" ectype="album_list_check">
                                            <li><a href="javascript:;" data-value="0" class="ftx-01">请选择...</a></li>
                                            {foreach from=$z_album_list item=z_list key=z_k}
                                                <li><a href="javascript:;" data-value="{$z_list.album_id}" class="ftx-01">{$z_list.album_mame}</a></li>
                                            {/foreach}
                                        </ul>
                                        <input name="z_cmsnew_id" type="hidden" value="{$z_album_id}" id="z_cmsnew_id_val">
                                </div>

                            </div>

                        </div>
                    </form>
                    <div class="table_list" ectype='z_cmsnew_list'>
                        <div class="gallery_album" data-act="get_cmsnew_pic" data-inid="z_cmsnew_list" data-url='visual_editing.php' data-where="sort_name={$filter.sort_name}&album_id={$filter.album_id}">
                            <ul class="ga-images-ul">
                                {foreach from=$z_pic_list item=z_pic_list}
                                    <li><a href="javascript:;" onclick="z_addpic('{$z_pic_list.pic_file}',this,'{$z_pic_list.url_cms}','{$z_pic_list.pic_title}','{$z_pic_list.article_id}','{$z_pic_list.class_id}','{z_$pic_list.label}')"><img src="{$z_pic_list.pic_file}"><span class="pixel">{$z_pic_list.pic_title}</span></a></li>
                                {foreachelse}
                                    <li class="notic">暂无新闻</li>
                                {/foreach}
                            </ul>
                            <div class="clear"></div>
                            {include file="library/lib_page.lbi"}
                        </div>
                    </div>
                </div>
            </div>
          	
        </div>	    
        <div class="body_info" style="display:none;">
    	    <div class="ps_table">
                <table id="r_addpictable" class="table">
                    <thead>
                        <tr>
                            <th>新闻封面</th>
                          
                                <th>新闻链接</th>
                                <th>新闻标题</th>
                                

                         

                            <th class="center">操作</th>
                       </tr>
                    </thead>
                   <tbody>
                        {foreach from=$r_banner_list item=r_item key=r_k}
                            <tr>
                                <td>
                                    <div class="img">
                                        <span><img src="{$r_item.pic_src}"></span>
                                        <input type="hidden" name="r_pic_src[]" value="{$r_item.pic_src}"/>
                                    </div>
                                </td>
                                {if $r_uploadImage neq 1}
                                    <td>
                                        <input type="text" name="r_link[]" value="{$r_item.link}" class="form-control">
                                    </td>
                                    <td>
                                        <input type="text" name="r_title[]" value="{$r_item.title}" class="form-control">
                                    </td>                                    
                                        <input type="hidden" name="r_article_id[]" value="{$r_item.article_id}">
                                        <input type="hidden" name="r_cms_label[]" value="{$r_item.cms_label}">
                                        <input type="hidden" name="r_class_id[]" value="{$r_item.class_id}">
                                {/if}
                                {if $r_titleup eq 1}
                                    <td class="center">
                                        <input type="text" value="{$r_item.title}" name="r_title[]" class="form-control small">
                                    </td>
                                    <td class="center">
                                        <input type="text" value="{$r_item.subtitle}" name="r_subtitle[]" class="form-control small">
                                    </td>
                                {/if}
                                <td class="center">
                                    <a href="javascript:;" class="pic_del del">删除</a>
                                </td>
                            </tr>
                        {foreachelse}
                            <tr class="notic">
                                <td colspan="5">点击下列新闻，可选中最多五个新闻</td>
                            </tr>    
                        {/foreach}
                    </tbody>
                </table>
            </div>
            <div class="images_space">
                <div class="goods_gallery mt20">
                    <form  action="" id="gallery_pic" method="post"  enctype="multipart/form-data"  runat="server" >
                        <div class="nav clearfix">
                            <div class="f_l">
                                <div class="imitate_select select_w220" id="r_cmsnew_id">
                                    <div class="cite">请选择新闻分类...</div>
                                        <ul style="display: none;" class="ps-container" ectype="album_list_check">
                                            <li><a href="javascript:;" data-value="0" class="ftx-01">请选择...</a></li>
                                            {foreach from=$r_album_list item=r_list key=r_k}
                                                <li><a href="javascript:;" data-value="{$r_list.album_id}" class="ftx-01">{$r_list.album_mame}</a></li>
                                            {/foreach}
                                        </ul>
                                        <input name="r_cmsnew_id" type="hidden" value="{$r_album_id}" id="r_cmsnew_id_val">
                                </div>

                            </div>

                        </div>
                    </form>
                    <div class="table_list" ectype='r_cmsnew_list'>
                        <div class="gallery_album" data-act="get_cmsnew_pic" data-inid="r_cmsnew_list" data-url='visual_editing.php' data-where="sort_name={$filter.sort_name}&album_id={$filter.album_id}">
                            <ul class="ga-images-ul">
                                {foreach from=$r_pic_list item=r_pic_list}
                                    <li><a href="javascript:;" onclick="r_addpic('{$r_pic_list.pic_file}',this,'{$r_pic_list.url_cms}','{$r_pic_list.pic_title}','{$r_pic_list.article_id}','{$r_pic_list.class_id}','{r_$pic_list.label}')"><img src="{$r_pic_list.pic_file}"><span class="pixel">{$r_pic_list.pic_title}</span></a></li>
                                {foreachelse}
                                    <li class="notic">暂无新闻</li>
                                {/foreach}
                            </ul>
                            <div class="clear"></div>
                            {include file="library/lib_page.lbi"}
                        </div>
                    </div>
                </div>
            </div>
          	
        </div>	 	        
        
    </div>
<script type="text/javascript">
    imitate_select();
    
    $.divselect("#cmsnew_id","#cmsnew_id_val",function(obj){
        var val = obj.attr("data-value");
        changednew(val,obj);
    });
    
    $.divselect("#z_cmsnew_id","#z_cmsnew_id_val",function(obj){
        var val = obj.attr("data-value");
        z_changednew(val,obj);
    });    
    $.divselect("#r_cmsnew_id","#r_cmsnew_id_val",function(obj){
        var val = obj.attr("data-value");
        r_changednew(val,obj);
    });       
    //select下拉默认值赋值
    function imitate_select(){
        $('.imitate_select').each(function(){
            var sel_this = $(this)
            var val = sel_this.children('input[type=hidden]').val();
            sel_this.find('a').each(function(){
                if($(this).attr('data-value') == val){
                    sel_this.children('.cite').html($(this).html());
                }
            })
        });
    } 

    
	function addpic(src,obj,url_cms,pic_title,article_id,class_id,label){
		var i = 0;
		var mode = "{$mode}";
		var length = "5";
        var uploadImage = "{$uploadImage}";
		var titleup = "{$titleup}";
		var id = $(obj).parents(".pb").attr("id");
		$("#addpictable").find('tr').each(function(){
			i++
		});
		
		if($("#addpictable").find('tr.notic').length>0){
			i-=1;
		}

		if( length< i  && length != 0){
			alert("此模块最多可添加"+length+"个新闻");
		}else{
            if(mode != "lunbo"){
				if(uploadImage == 1){
					var html = '<tr><td><div class="img"><span><img src="'+src+'"></span><input type="hidden" name="pic_src[]" value="'+src+'"/></div></td><td class="center"><a href="javascript:;" class="pic_del del">删除</a></td></tr>';
				}else{
					var title = '';
					if(titleup == 1){
						title = '<td class="center"><input type="text" value="" name="title[]" class="form-control small"></td><td class="center"> <input type="text" value="" name="subtitle[]" class="form-control small"></td>';
					}
					var html = '<tr><td><div class="img"><span><img src="'+src+'"></span><input type="hidden" name="pic_src[]" value="'+src+'"/></div></td><td><input type="text" name="link[]" value="'+url_cms+'" class="form-control"></td><td><input type="text" name="title[]" value="'+pic_title+'" class="form-control"></td><input type="hidden" name="article_id[]" value="'+article_id+'" ><input type="hidden" name="cms_label[]" value="'+label+'" ><input type="hidden" name="class_id[]" value="'+class_id+'" >' + title + '<td class="center"><a href="javascript:;" class="pic_del del">删除</a></td></tr>';
				}
			}else{
				var html = '<tr><td><div class="img"><span><img src="'+src+'"></span><input type="hidden" name="pic_src[]" value="'+src+'"/></div></td><td><input type="text" name="link[]" class="form-control"></td><td><input type="text" name="title[]" class="form-control"></td><td class="center"><input type="text" value="1" name="sort[]" class="form-control small"></td><td class="center"><input type="text" value="" name="bg_color[]" class="form-control small"></td><td class="center"><a href="javascript:;" class="pic_del del">删除</a></td></tr>';
			}
			
			if($("#addpictable").find(".notic").length>0){
				$("#addpictable").find(".notic").remove();
			}
			$("#addpictable").find("tbody").prepend(html);
		}
		
		pbct("#"+id);
	}
	function z_addpic(src,obj,url_cms,pic_title,article_id,class_id,label){
		var i = 0;
		var mode = "{$mode}";
		var length = "5";
        var uploadImage = "{$uploadImage}";
		var titleup = "{$titleup}";
		var id = $(obj).parents(".pb").attr("id");
		$("#z_addpictable").find('tr').each(function(){
			i++
		});
		
		if($("#z_addpictable").find('tr.notic').length>0){
			i-=1;
		}

		if( length< i  && length != 0){
			alert("此模块最多可添加"+length+"个新闻");
		}else{
            if(mode != "lunbo"){
				if(uploadImage == 1){
					var html = '<tr><td><div class="img"><span><img src="'+src+'"></span><input type="hidden" name="pic_src[]" value="'+src+'"/></div></td><td class="center"><a href="javascript:;" class="pic_del del">删除</a></td></tr>';
				}else{
					var title = '';
					if(titleup == 1){
						title = '<td class="center"><input type="text" value="" name="title[]" class="form-control small"></td><td class="center"> <input type="text" value="" name="subtitle[]" class="form-control small"></td>';
					}
					var html = '<tr><td><div class="img"><span><img src="'+src+'"></span><input type="hidden" name="z_pic_src[]" value="'+src+'"/></div></td><td><input type="text" name="z_link[]" value="'+url_cms+'" class="form-control"></td><td><input type="text" name="z_title[]" value="'+pic_title+'" class="form-control"></td><input type="hidden" name="z_article_id[]" value="'+article_id+'" ><input type="hidden" name="z_cms_label[]" value="'+label+'" ><input type="hidden" name="z_class_id[]" value="'+class_id+'" >' + title + '<td class="center"><a href="javascript:;" class="pic_del del">删除</a></td></tr>';
				}
			}else{
				var html = '<tr><td><div class="img"><span><img src="'+src+'"></span><input type="hidden" name="pic_src[]" value="'+src+'"/></div></td><td><input type="text" name="link[]" class="form-control"></td><td><input type="text" name="title[]" class="form-control"></td><td class="center"><input type="text" value="1" name="sort[]" class="form-control small"></td><td class="center"><input type="text" value="" name="bg_color[]" class="form-control small"></td><td class="center"><a href="javascript:;" class="pic_del del">删除</a></td></tr>';
			}
			
			if($("#z_addpictable").find(".notic").length>0){
				$("#z_addpictable").find(".notic").remove();
			}
			$("#z_addpictable").find("tbody").prepend(html);
		}
		
		pbct("#"+id);
	}
	function r_addpic(src,obj,url_cms,pic_title,article_id,class_id,label){
		var i = 0;
		var mode = "{$mode}";
		var length = "8";
        var uploadImage = "{$uploadImage}";
		var titleup = "{$titleup}";
		var id = $(obj).parents(".pb").attr("id");
		$("#r_addpictable").find('tr').each(function(){
			i++
		});
		
		if($("#r_addpictable").find('tr.notic').length>0){
			i-=1;
		}

		if( length< i  && length != 0){
			alert("此模块最多可添加"+length+"个新闻");
		}else{
            if(mode != "lunbo"){
				if(uploadImage == 1){
					var html = '<tr><td><div class="img"><span><img src="'+src+'"></span><input type="hidden" name="pic_src[]" value="'+src+'"/></div></td><td class="center"><a href="javascript:;" class="pic_del del">删除</a></td></tr>';
				}else{
					var title = '';
					if(titleup == 1){
						title = '<td class="center"><input type="text" value="" name="title[]" class="form-control small"></td><td class="center"> <input type="text" value="" name="subtitle[]" class="form-control small"></td>';
					}
					var html = '<tr><td><div class="img"><span><img src="'+src+'"></span><input type="hidden" name="r_pic_src[]" value="'+src+'"/></div></td><td><input type="text" name="r_link[]" value="'+url_cms+'" class="form-control"></td><td><input type="text" name="r_title[]" value="'+pic_title+'" class="form-control"></td><input type="hidden" name="r_article_id[]" value="'+article_id+'" ><input type="hidden" name="r_cms_label[]" value="'+label+'" ><input type="hidden" name="r_class_id[]" value="'+class_id+'" >' + title + '<td class="center"><a href="javascript:;" class="pic_del del">删除</a></td></tr>';
				}
			}else{
				var html = '<tr><td><div class="img"><span><img src="'+src+'"></span><input type="hidden" name="pic_src[]" value="'+src+'"/></div></td><td><input type="text" name="link[]" class="form-control"></td><td><input type="text" name="title[]" class="form-control"></td><td class="center"><input type="text" value="1" name="sort[]" class="form-control small"></td><td class="center"><input type="text" value="" name="bg_color[]" class="form-control small"></td><td class="center"><a href="javascript:;" class="pic_del del">删除</a></td></tr>';
			}
			
			if($("#r_addpictable").find(".notic").length>0){
				$("#r_addpictable").find(".notic").remove();
			}
			$("#r_addpictable").find("tbody").prepend(html);
		}
		
		pbct("#"+id);
	}  		
</script>
    
    
    
{/if}